
Trend
 Micro 



About
 TrendLabs Security Intelligence Blog 



Search:Goto…HomeCategoriesHome...Exploits... First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group 
First Active Attack Exploiting CVE-2019-2215Found on Google Play, Linked to SideWinder APTGroup 

Posted on:January 6, 2020 
at 5:00 am 

Posted in:Exploits, Mobile 


Author: 
Trend Micro 
group that has been active since 2012, is a known threat and has reportedly targeted military entities’ 
Windows machines. 

0by.Ecular Xu and Joseph C Chenattack in the wild that uses the Willyoutakeafewmomentstoanswerafewques\tionssurroundingyourblogpreferences?STARTThe three malicious apps were disguised as photography and .le manager tools. We speculate that these appshave been active since March 2019 based on the certi.cate information on one of the apps. The apps havesince been removed from Google Play. 
Figure 1. The three apps related to SideWinder group 
URL used in the distribution of the malware. 
Figure 2. Certi.cate information of one of the apps 
Installation 

Figure 3. Parsed C&C Server address 
After this step, the downloaded DEX .le downloads an APK .le and installs it after exploiting the device oremploying accessibility. All of this is done without user awareness or intervention. To evade detection, it usesmany techniques such as obfuscation, data encryption, and invoking dynamic code. 
The apps Camero and FileCrypt Manger act as droppers. After downloading the extra DEX .le from theC&C server, the second-layer droppers invoke extra code to download, install, and launch the callCam app onthe device. 
Willyoutakeafewmomentstoanswerafewques\tionssurroundingyourblogpreferences?STARTTo deploy the payload app callCam on the device without the user’s awareness, SideWinder does thefollowing: 
1. Device RootingThis approach is done by the dropper app Camero and only works on Google Pixel (Pixel 2, Pixel 2 XL),Nokia 3 (TA-1032), LG V20 (LG-H990), Oppo F9 (CPH1881), and Redmi 6A devices. The malwareretrieves a speci.c exploit from the C&C server depending on the DEX downloaded by the dropper. 
Figure 6. Code snippet from Extra DEX downloaded by Camero 
We were able to download .ve exploits from the C&C server during our investigation. They use thevulnerabilities CVE-2019-2215 and MediaTek-SU to get root privilege. 
Figure 7. CVE-2019-2215 exploitWillyoutakeafewmomentstoanswerafewques\tionssurroundingyourblogpreferences?STARTFigure 8. MediaTek-SU exploit 
After acquiring root privilege, the malware installs the app callCam, enables its accessibility permission, andthen launches it. 
Figure 9. Commands install app, launch app, and enable accessibility 
2. Using the Accessibility PermissionThis approach is used by the dropper app FileCrypt Manager and works on most typical Android phonesabove Android 1.6. After its launch, the app asks the user to enable accessibility. 
Will you take a few moments to answer a few ques-tions surrounding your blog preferences? 
START 
Figure 10. Steps FileCrypt Manager prompts user to do 
Once granted, the app shows a full screen window that says that it requires further setup steps. In reality, thatis just an overlay screen that is displayed on top of all activity windows on the device. The overlay windowsets its attributions to FLAG_NOT_FOCUSABLE and FLAG_NOT_TOUCHABLE, allowing the activitywindows to detect and receive the users’ touch events through the overlay screen. 

Meanwhile, the app invokes code from the extra DEX .le to enable the installation of unknown apps and theinstallation of the payload app callCam. It also enables the payload app’s accessibility permission, and thenlaunches the payload app. All of this happens behind the overlay screen, unbeknownst to the user. And, allthese steps are performed by employing Accessibility. 
Figure 12. Code enabling install of unknown apps and new APK 
Figure 13. Code enable accessibility permission of the newly installed app 

callCam’s Activities 
The app callCam hides its icon on the device after being launched. It collects the following information andsends it back to the C&C server in the background: 

Location 


Battery status


Files
 on device 


Installed
 app list


Device
 information 


Sensor
 information 


Camera
 information Screenshot Account 


Wi.
 information 


Data
 of WeChat, Outlook, Twitter, Yahoo Mail, Facebook, Gmail, and Chrome 





The app encrypts all stolen data using RSA and AES encryption algorithms. It uses SHA256 to verify dataintegrity and customize the encoding routine. When encrypting, it creates a block of data we namedheadData. This block contains the .rst 9 bytes of origin data, origin data length, random AES IV, the RSA-encrypted AES encrypt key, and the SHA256 value of AES-encrypted origin data. Then the headData isencoded through the customized routine. After the encoding, it is stored in the head of the .nal encrypted .lefollowed by the data of the AES-encrypted original data. 
Figure 14. Data encryption process 

Relation to SideWinder 
These apps may be attributed to SideWinder as the C&C servers it uses are suspected to be part of. In addition, a URL linking to one of the apps’ Google Play pages is also foundSideWinder’s infrastructureon one of the C&C servers. 
Figure 16. Google Play URL of FileManager app found in one of the C&C servers. 

Trend Micro Solutions 
Trend Micro solutions such as the Trend Micro. Mobile Security for Android. can detect these malicious apps. End users can also bene.t from its multilayered security capabilities that secure the device owner’s dataand privacy and safeguard them from ransomware, fraudulent websites, and identity theft. 
For organizations, the Trend Micro Mobile Security for Enterprise suite provides device, compliance, andapplication management, data protection, and con.guration provisioning. It also protects devices from attacksthat exploit vulnerabilities, prevents unauthorized access to apps, and detects and blocks malware andfraudulent websites. Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS threatsusing leading sandbox and machine learning technologies to protect users against malware, zero-day andknown exploits, privacy leaks, and application vulnerabilities. 
Indicators of Compromise 

SHA256 Package Name/File type App Name/Detection
Name 
ec4d6bf06dd3f94f4555d75c6daaf540dee15b18d62cc004 AndroidOS_SWinderS 
DEX
e774e996c703cb34 py.HRXA 
a60fc4e5328dc75dad238d46a2867ef7207b8c6fb73e8bd0 AndroidOS_SWinderS 
DEX
01b323b16f02ba00 py.HRXA 
0daefb3d05e4455b590da122255121079e83d48763509b0 ELF AndroidOS_MtkSu.A
688e0079ab5d48886 
441d98dff3919ed24af7699be658d06ae8dfd6a12e4129a3 AndroidOS_BinderEx
ELF
85754e6218bc24fa p.A
ac82f7e4831907972465477eebafc5a488c6bb4d460575c AndroidOS_BinderEx
ELF
d3889226c390ef8d5 p.A
ee679afb897213a3fd09be43806a7e5263563e86ad255fd5 AndroidOS_BinderEx
ELF
00562918205226b8 p.A
135cb239966835fefbb346165b140f584848c00c4b6a724 
ce122de7d999a3251 
73d2bb915d198ae42 

Package Name/File type 
Name 
com.abdulrauf..lemanager
com.callCam.android.callCam2base 

1/6/2020 First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog 
com.camero.android.camera2basic Camero 

C&C Servers 
ms-ethics.net deb-cn.net ap1-acl.net ms-db.net aws-check.net reawk.net 
MITRE ATT&CK Matrix. 
Willyoutakeafewmomentstoanswerafewques\tionssurroundingyourblogpreferences?STARTENTERPRISE 
. 
Tags: appAPTgoogle play 


0 Comments TrendLabs 



. Recommend t Tweet f Share Sort by Best 

Start the discussion… 


Be the .rst to comment. 
. 
Subscribe 
d 
Add 
Disqus 
to 
your 
siteAdd 
DisqusAdd 
.. 
Disqus' 
Privacy 
PolicyPrivacy 
PolicyPrivacy 


Featured Stories 

systemd
 Vulnerability Leads to Denial of Service on Linux


qkG
 Filecoder: Self-Replicating, Document-Encrypting Ransomware


Mitigating
 CVE-2017-5689, an Intel Management Engine Vulnerability


A
 Closer Look at North Korea’s Internet 



From
 Cybercrime to Cyberpropaganda 




Security Predictions for 2019 

Our security predictions for 2019 are based on our experts’ analysis of the progress of current andemerging technologies, user behavior, and market trends, and their impact on the threat landscape. Wehave categorized them according to the main areas that are likely to be affected, given the sprawlingnature of the technological and sociopolitical changes under consideration.
Read our security predictions for 2019. 


Business Process Compromise 


leverage or abuse. To learn more, 
1/6/2020 First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog 

Recent Posts 

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APTGroup


Looking into Attacks and Techniques Used Against WordPress Sites

Why Running a Privileged Container in Docker Is a Bad Idea

DDoS Attacks and IoT Exploits: New Activity from Momentum Botnet

More than a Dozen Obfuscated APT33 Botnets Used for Extreme Narrow Targeting 



Popular Posts 
More than a Dozen Obfuscated APT33 Botnets Used for Extreme Narrow Targeting 

Banking Trojan DRIDEX Uses Macros for Infection 

Microsoft November 2019 Patch Tuesday Reveals 74 Patches Before Major Windows Update 

(Almost) Hollow and Innocent: Monero Miner Remains Undetected via Process Hollowing 

April Patch Tuesday: Microsoft Patches Of.ce Vulnerability Used in Zero-Day Attacks 


Stay Updated 
YouremailhereSubscribeEmail Subscription 
Home and Home Of.ce 

|

For Business 


|


Security Intelligence

|


About Trend Micro 


Asia Paci.c Region (APAC): Australia / New Zealand, 中国, .本, ...., 台 


Latin America Region (LAR): Brasil, México 


North America Region (NABU): United States, Canada 



Europe, Middle East, & Africa Region (EMEA): France, Deutschland / .sterreich / Schweiz, Italia,Россия, Espa.a, United Kingdom / Ireland 


Privacy Statement

Legal Policies 


Copyright . 2020 Trend Micro Incorporated. All rights reserved. 

Will you take a few moments to answer a few ques-tions surrounding your blog preferences? 
START 


