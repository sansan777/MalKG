
Trend
 Micro 



About
 TrendLabs Security Intelligence Blog 



Search:Goto…HomeCategoriesHome...Malware... Operation Poisoned News: Hong Kong Users Targeted With Mobile Malware via Local News Links 
Operation Poisoned News: Hong Kong Users Targeted With MobileMalware via Local News Links 

Posted on:March 24, 2020 
at 5:01 am 

Posted in:Malware, Mobile 
Author: 

Trend Micro 


By Elliot Cao, Joseph C. Chen, William Gamazo Sanchez, Lilang Wu, and Ecular Xu 
A recently discovered watering hole attack has been targeting iOS users in Hong Kong. The campaign uses links posted on multiple forums that supposedlylead to various news stories. While these links lead users to the actual news sites, they also use a hidden iframe to load and execute malicious code. Themalicious code contains exploits that target vulnerabilities present in iOS 12.1 and 12.2. Users that click on these links with at-risk devices will download anew iOS malware variant, which we have called lightSpy.(detected as IOS_LightSpy.A). 
The malware variant is a modular backdoor that allows the threat actor to remotely execute shell command and manipulate .les on the affected device. Thiswould an allow an attacker to spy on a user’s device, as well as take full control of it. It contains different modules for ex.ltrating data from the infecteddevice, which includes: 

Connected
 WiFi historyContacts 


GPS
 location 


Hardware
 information 


iOS
 keychain


Phone
 call history


Safari
 and Chrome browser history


SMS
 messages 



Information about the user’s network environment is also ex.ltrated from the target device: 

Available
 WiFi network 


Local
 network IP addresses 


Messenger applications are also speci.cally targeted for data ex.ltration. Among the apps speci.cally targeted are: 

Telegram

QQ

WeChat 
Our research also uncovered a similar campaign aimed at Android devices in 2019. Links to malicious .APK .les were found on various public Hong Kong-related Telegram channels. These messages claimed they were for various legitimate apps, but they led to malicious apps that could.ex.ltrate deviceinformation, contacts, and SMS messages. We called this Android malware family dmsSpy (variants of of.dmsSpy.are detected as AndroidOS_dmsSpy.A.). 
The design and functionality of operation suggests that the campaign isn’t meant to target victims, but aims to compromise as many mobile devices aspossible for device backdooring and surveillance. We named the campaign Operation Poisoned News based on its distribution methods. 
This blog post provides a high-level overview of the capabilities of both lightSpy and dmsSpy, as well as their distribution methods. Further technical details,including indicators of compromise (IoCs), are contained in the related technical brief. 
Distribution: Poisoned News and Watering Holes 
On February 19, we identi.ed a watering hole attack targeting iOS users. The URLs used led to a malicious website created by the attacker, which in turncontained three iframes that pointed to different sites. The only visible iframe leads to a legitimate news site, which makes people believe they.are visiting thesaid site. One invisible iframe was used for website analytics; the other led to a site hosting the main script of the iOS exploits. The screenshot below showsthe code of these three iframes: 
Figure 1. HTML code of malicious website, with three iframes 
Links to these malicious sites were posted on four different forums, all known to be popular with Hong Kong residents. These forums also provide their userswith an app, so that their readers can easily visit it on their mobile devices. Poisoned News posted its links in the general discussion sections of the saidforums. The post would include the headline of a given news story, any accompanying images, and the (fake) link to the news site. 
The articles were posted by newly registered accounts on the forums in question, which leads us to believe that these posts were.not.made by users resharinglinks that they thought were legitimate. The topics used as lures were either sex-related, clickbait-type headlines, or news related to the COVID-19 disease.We do not believe that these topics were targeted at any users.speci.cally; instead they targeted the users of the sites as a whole. 
Figure 2. List of news topics posted by the campaignFigure 3. Forum post with the link to malicious siteAside from the above technique, we also saw a second type of watering hole website. In these cases, a legitimate site was copied and injected with a maliciousiframe. Our telemetry indicates that the distribution of links to this type of watering hole in Hong Kong started on January 2. However, we do not know wherethese links were distributed. 
Figure 4. Copied news page with iframe with malicious exploit 
These attacks continued into March 20, with forum posts that supposedly linked to a schedule for protests in Hong Kong. The link would instead lead to thesame infection chain as in the earlier cases. 
Figure 5. Link to malicious site claiming to be a schedule 

Infection Chain 
The exploit used in this attack affects iOS 12.1 and 12.2. It targets a variety of iPhone models, from the iPhone 6S up to the iPhone X, as seen in the codesnippet below: 
Figure 6. Code checking for target devices 
The full exploit chain involves a silently patched Safari bug (which works on multiple recent iOS versions) and a customized kernel exploit. Once the Safaribrowser renders the exploit, it targets a bug (which Apple silently patched in newer iOS versions), leading to the exploitation of a known kernel vulnerabilityto gain root privileges. The kernel bug is connected to.CVE-2019-8605. The silently patched Safari bug does not have an associated CVE, although other 
researchers mentioned a history of failed patches related to this particular issue. 

Once the device is compromised, the attacker installs an undocumented and sophisticated spyware for maintaining control over the device and ex.ltrateinformation. The spyware used a modular design with multiple capabilities, including the following: 

Modules
 update


Remote
 command dispatch per module


Complete
 shell command module 


Many of this spyware’s modules were designed explicitly for data ex.ltration; for example, modules that steal information from Telegram and Wechat areboth included. The .gure below shows the infection chain and the various modules it uses. 
Figure 7. Diagram of lightSpy’s infection chain 
We chose to give this new threat the name.lightSpy,.from the name of the module manager, which is.light. We also note that a decoded con.guration .le that the.launchctl.module uses includes a URL that points to a./androidmm/light.location, which suggests that an Android version of this threat exists as well. 
One more note: The .le.payload.dylib.is signed with the legitimate Apple developer certi.cate, and was only done so on November 29, 2019. This places ade.nite timestamp on the start of this campaign’s activity. 
Overview of Malicious Behavior of lightSpy 
This section of the blog post provides a short overview of.lightSpy.and its associated payloads (space constraints limit the details we can provide). However,we provided more technical details in the technical brief. 
When the kernel exploit is triggered, payload.dylib proceeds to download multiple modules, as seen in the code below: 
Figure 8. Downloaded modules 
Some of these modules are associated with startup and loading. For example,.launchctl.is a tool used to load or unload daemons/agents, and it does thisusing.ircbin.plist.as an argument. This daemon, in turn, executes.irc_loader, but (as the name implies) it is just a loader for the main malware module,.light. It does, however, contain the hardcoded location of the C&C server. 
The.light.module serves as the main control for the malware, and is capable of loading and updating the other modules. The remaining modules are designedto extract and ex.ltrate different types of data, as seen in the following list: 

dylib
 C acquires and uploads basic information such as iPhone hardware information, contacts, text messages, and call history


ShellCommandaaa
 C executes shell commands on the affected device; any results are serialized and uploaded to a speci.ed server


KeyChain
 C steals and uploads information contained in the Apple KeyChain


Screenaaa
 C scans for and pings devices on the same network subnet as the affected device; the ping’s results are uploaded to the attackers


SoftInfoaaa
 C acquires the list of apps and processes on the device


FileManage
 C performs .le system operations on the device


Wi.List
 C acquires the saved Wi-Fi information (saved networks, history, etc.).


browser
 C acquires the browser history from both Chrome and Safari.


Locationaaa
 C gets the user’s location.



ios_wechat C acquires information related to WeChat, including: account information, contacts, groups, messages, and .les.

ios_qq C similar to the.ios_wechatmodule, but for QQ.

ios_telegram C similar to the previous two modules, but for Telegram. 
Taken together, this threat allows the threat actor to thoroughly compromise an affected device and acquire much of what a user would consider con.dentialinformation. Several chat apps popular in the Hong Kong market were particularly targeted here, suggesting that these were the threat actor’s goals. 
Overview of dmsSpy 
As noted earlier in this blog post, there is an Android counterpart to.lightSpy.which we have called.dmsSpy..These variants were distributed in publicTelegram channels disguised as various apps in 2019. While the links were already invalid during our research, we were able to obtain a sample of one of thevariants. 
Our sample was advertised as a calendar app containing protest schedules in Hong Kong. It contains many features that we frequently see in malicious apps,such as requests for sensitive permissions, and the transmission of sensitive information to a C&C server. This includes seemingly safe information such asthe device model used, but includes more sensitive information such as contacts, text messages, the user’s location, and the names of stored .les. dmsSpy alsoregisters a receiver for reading newly received SMS messages, as well as dialing USSD codes. 
We were able to obtain more information about dmsSpy.because the threat actors behind it erroneously left the debug mode of their web framework activated.This allowed us a peek of the APIs used by the server. It suggest further capabilities we did not see in our sample, including screenshots and the ability toinstall APK .les onto the device. 
We believe that these attacks are related. dmsSpy’s download and command-and-control servers used the same domain name (hkrevolution[.]club) as one ofthe watering holes used by the iOS component of Poisoned News. (They did use differing subdomains, however). As a result, we believe that this particularAndroid threat is operated by the same group of threat actors, and is connected to, Poisoned News. 

Vendor statements 
We reached out to the various vendors mentioned in this blog post. Tencent had this to say: 
This report by Trend Micro is a great reminder of why it’s important to keep the operating system on computers and mobile devices up to date.
The vulnerabilities documented in the report, which affected the Safari web browser in iOS 12.1 and 12.2, were .xed in subsequent updates to
iOS. 
A very tiny percentage of our WeChat and QQ users were still running the older versions of iOS that contained the vulnerability. We have already
issued a reminder to these users to update their devices to the latest version of iOS as soon as possible. 
Tencent takes data security extremely seriously and will continue to strive to ensure that our products and services are built on robust, secure
platforms designed to keep user data safe. 
Apple has also been noti.ed of this research through Trend Micro’s Zero Day Initiative (ZDI). We also reached out to Telegram on our .ndings and have notreceived a response at the time of publication. 
Best practices and solutions 
Several steps could have been taken by users to mitigate against this threat. For iOS users, the most important would be to keep their iOS version updated.Updates that would have resolved this problem have been available for more than a year, meaning that a user who had kept their device on the latest updatewould have been safe from the vulnerability that this threat exploits. 
For Android users, the samples we obtained were distributed via links in Telegram channels, outside of the Google Play store. We strongly recommend thatusers avoid installing apps from outside trusted app stores, as apps distributed in this manner are frequently laden with malicious code. 
Users can also install security solutions, such as the.Trend Micro. Mobile Security for iOS.and.Trend Micro. Mobile Security for Android..(alsoavailable on.Google Play) solutions, that can block malicious apps. End users can also bene.t from their multilayered security capabilities that secure thedevice owner’s data and privacy, and features that protect them from ransomware, fraudulent websites, and identity theft. 
For organizations, the.Trend Micro. Mobile Security for Enterprise.suite provides device, compliance and application management, data protection, andcon.guration provisioning. The suite also protects devices from attacks that exploit vulnerabilities, prevents unauthorized access to apps and detects andblocks malware and fraudulent websites..Trend Micro’s Mobile App Reputation Service.(MARS) covers Android and iOS threats using leading sandboxand.machine learning.technologies to protect users against malware, zero-day and known exploits, privacy leaks, and application vulnerability. 
Indicators of compromise and full technical details of this attack may be found in the accompanying technical brief. 

Related Posts: 

Anubis
 Android Malware Returns with Over 17,000 Samples


Malicious
 Optimizer and Utility Android Apps on Google Play Communicate with Trojans that Install Malware, Perform Mobile Ad Fraud


Dissecting
 Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks


Fake
 Photo Beauti.cation Apps on Google Play can Read SMS Veri.cation Code to Trigger Wireless Application Protocol (WAP)/CarrierBilling 




Learn how to protect Enterprises, Small Businesses, and Home Users from ransomware: 
ENTERPRISE 
. SMALL BUSINESS 
. HOME 
. 
Tags: androiddmsSpyiOSlightSpyOperation Poisoned News 

0 Comments TrendLabs 
.. 
Privacy 
Policy 
]1 Login . Recommend t Tweet f Share Sort by Best 



Start the discussion… 
LOG IN WITH OR SIGN UP WITH DISQUS 
? 

Name 
Be the .rst to comment. 
. 
Subscribe 
d 
Add 
Disqus 
to 
your 
siteAdd 
DisqusAdd 
D NtSll MDt
. 
Security Predictions for 2020 

Cybersecurity in 2020 will be viewed through many lenses ― from differing attacker motivations and cybercriminal arsenal to technologicaldevelopments and global threat intelligence ― only so defenders can keep up with the broad range of threats.
Read our security predictions for 2020. 


Business Process Compromise 

Attackers are starting to invest in long-term operations that target speci.c processes enterprises rely on. They scout for vulnerable practices, susceptiblesystems and operational loopholes that they can leverage or abuse. To learn more, read our Security 101: Business Process Compromise. 


Recent Posts 

Operation Poisoned News: Hong Kong Users Targeted With Mobile Malware via Local News Links

OpenSMTPD Vulnerability (CVE-2020-8794) Can Lead to Root Privilege Escalation and Remote Code Execution

Operation Overtrap Targets Japanese Online Banking Users Via Bottle Exploit Kit and Brand-New Cinobi Banking Trojan

March Patch Tuesday: LNK, Microsoft Word Vulnerabilities Get Fixes, SMBv3 Patch Follows

Busting Ghostcat: An Analysis of the Apache Tomcat Vulnerability (CVE-2020-1938 and CNVD-2020-10487) 



Popular Posts 
LokiBot Impersonates Popular Game Launcher and Drops Compiled C# Code File 

Miscon.gured Container Abused to Deliver Cryptocurrency-mining Malware 

Dissecting Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks 

Outlaw Updates Kit to Kill Older Miner Versions, Targets More Systems 

February Patch Tuesday: Fixes for Critical LNK, RDP, Trident Vulnerabilities 


Stay Updated 
YouremailhereSubscribeEmail Subscription 
Home and Home Of.ce 

|

For Business 


|

Security Intelligence

|


About Trend Micro 



Asia Paci.c Region (APAC): Australia / New Zealand, 中国, .本, ...., 台 
https://blog.trendmicro.com/trendlabs-security-intelligence/operation-poisoned-news-hong-kong-users-targeted-with-mobile-malware-via-local-news-links/ 

Latin
 America Region (LAR): Brasil, México 



North
 America Region (NABU): United States, Canada 




Europe, Middle East, & Africa Region (EMEA): France, Deutschland / .sterreich / Schweiz, Italia, Россия, Espa.a, United Kingdom / Ireland 


Privacy
 Statement


Legal
 Policies 



Copyright
 . 2020 Trend Micro Incorporated. All rights reserved. 





