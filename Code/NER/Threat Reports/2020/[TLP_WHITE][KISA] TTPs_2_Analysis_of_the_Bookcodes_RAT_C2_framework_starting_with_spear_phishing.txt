
CONTENTS 
1. Introduction ¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤1 
` 

2. Overview ¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤2 
3. 
ATT&CK Matrix¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤5 

4. 
Malware Analysis ¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤37 5. Conclusion ¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤67 


6. Yara Rule ¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤¡¤ 
The content of this report may not be reproduced or copied in whole or part without the permission of the Korea Internet & Security Agency (KISA); any breach thereof constitutes a violation of copyright law. 
Written by: Profound Analysis Team,  Internet Incidents Analysis Division Kim Dong Wook, Deputy General Researcher Kim Byeong Jae, Deputy General Researcher Lee Tae Woo, Deputy General Researcher Ryu So Jun, Researcher  Lee Jae Gwang, Manager 
Edited by:  Shin Dae-Kyu, Vice President  Lee Dong Geun, Director 
 
1. Introduction 
As hacking incidents persist with increasing frequency these days, security requirements are becoming more stringent, and the capabilities of security systems are evolving to high levels. Nevertheless, past cyber incidents continue to occur and even companies with well-established cyber-defense systems are not immune from such cyber threats. 
The Pyramid of Pain, a well-known concept in the field of cybersecurity, shows that the most effective form of defense for defenders consists in understanding the TTPs (Tactics, Techniques, Procedures) of attackers, and operating the cyber-defense system accordingly. The best security is to force attackers to the Tough! level shown in the pyramid. 
  	 . ¡¦	 	.¨B 	 .¡¦	..¡ã¡¦.  
A defense system based on the IoC(Indicator of Compromise), which refers to a simple indicator such as a malicious IP or domain, is still very useful. But it is possible for an attacker to easily secure and then discard an attack infrastructure related to a simple indicator. 
However, the TTPs approach is different. Attackers cannot easily obtain or discard the TTPs. An attacker who selected a target spends considerable time learning and practicing the TTPs in order to disable the target's defense system, and then the attacker selects new targets to which those TTPs can be applied. 
Attackers¡¯ TTPs are always closely associated with the nature of the defense environment. Thus, defenders must be very aware of their defense environment and view the flow and process of attacks from a strategic and tactical perspective, rather than as a pattern or a technique. The defender's environment and the attacker's TTPs must be dealt with together. 
 
 A defender who understands the attacker¡¯s TTPs should be able to answer the following two questions:
-¡°Are the attacker's TTPs valid for the defender's environment?¡±
-¡°If so, what are the defense strategies that can disrupt the TTPs?¡± 
The Korea Internet & Security Agency(KISA) and KrCERT/CC identifies attackers¡¯ TTPs through its incident response process, and then shares information on how to respond to and counteract based on the ATT&CK Framework.1) The various artifacts related to TTPs included in this report are tools to assists readers in understanding the TTPs. 
1) A matrix of tactics and techniques used in attacks and the related countermeasures 
 
2. Overview 
Aware of the TTPs#1(Controlling local network through vulnerable web-site)2) report released in April 2020, att ackers sought to immediately replace easily changeable information such as IP addresses and public web shells. However they continue to use strategies and tactics such as method of initial access, malware types, and attack network configuration without making significant changes. Therefore, the TTPs-based response is effective because attackers cannot easily change the tactics and strategies they have used for a long time. 
One-shot measures and responses will ultimately fail to address current threats and can lead to further incidents. Defenders should aim to identify the limitations of current response methods and build defense strategies from a defender's point of view in line with their respective system environments. Defenders should constantly refer to these TTPs reports to consider defense strategies that can be adapted to their environment. 
This TTPs#2 report details the initial access methods, internal information collection methods, and malware analysis information. This report will identify the purpose and intention of the attacker's infiltration and provide characteristic information such as specific functions of malware to help establish specific defense strategies. 
!"# 	¨B$  . ¨B¨B.. 
2) 	
 
   

 	 .¡¦.¨B.¨B¨B. 
!!%¡ã&&		.¨B 
 Attack Preparation 
First, attackers take control of a hosting server that operates multiple websites to use as a base. They upl oad web shells through vulnerable websites like those described in the TTPs#1 report and attempt to escalate privileges by attacking vulnerabilities in the host system. An attacker who succeeds in obtaining administrator privileges for the system can execute all actions such as web source code tampering, database access, and more. 
 Send Spear Phishing to Attack Target 
Once they¡¯ve gained a foothold, attackers will select their targets. They collect publicly disclosed email addresses and write emails with content related to the victim¡¯s work responsibilities. Attackers then sends authentic-looking emails to induce the recipients to open attachments containing malware or to access co mpromised websites. Thus, employees in charge of personnel and sales who have more contact with peo ple outside the company are more exposed to attacks than IT professionals. 
 Initial Access 
An attacker uses two methods when infecting an attack target. The first method is to attach malicious Ha ngul word processor files, and the second is to insert vulnerability codes into the bases secured during the preparation of the attack and induce access. 
 System Information Collection 
Upon successful initial access, attackers collect basic system information such as network information, host name, etc. They then identify the secured privileges and internal network structure and decide whether to perpetrate further malicious action. Attackers can also connect their drive remotely to an infected system to install additional malware and collect command results more easily. 
 Privilege Escalation 
An attacker has limited privileges upon initial access and requires administrator privileges to perform more operations. Therefore, they use malware or tools that cause vulnerabilities to elevate privileges. of authority are used. 
 Securing Persistence 
Even if the initial access successful, the malware may be terminated due to a reboot of the infected device or an unexpected process crash, resulting in the loss of the intrusion path. To prevent this, an attacker registers the service, sets up the startup program, registers the task scheduler, and inserts the web shell so that the malware can be executed again. 
 Internal Information Collection 
In earnest, tAn attacker will collect confidential internal documents, entire network structure, and account credentials of infected devices through malware. Attackers also use normal programs to collect information efficiently and easily and avoid detection of vaccines.by anti-virus software. 
 Lateral Movement 
Attackers attempt to connect to the shared network using the previously collected account information. Subsequently, the process from ' system information collection' to ' internal information collection' is repeated to reach the main system containing critical information. If there is a network separation policy in place, the attacker may find a system (network linkage solution, DRM solution, etc.) that conn ects the external and internal environment, and attempt an attack by identifying vulnerabilities in the system. 
	 Trace Removal 
Malware and tools used in the attack are immediately deleted to remove traces. At this time, malware installed to secure persistence is excluded. 
          
3. ATT&CK Matrix 
A. Initial Access 
 	 
	 
 	  	
 
The attacker infiltrated the target companies using spear phishing e-mails with malicious hangul word processor documents (hwp files) attached. The attacker attached files related to an actual seminar to make the emails appear legitimate. When the attachment is opened, a remote-controlled malware is installed and communicates with the command and control(C&C). 
Response Strategy 
-Introduce a spam mail detection and prevention system 
-Maintain the latest versions of Hancom processor and Microsoft Office programs 
-Check the extension of the attached file and do not open if it is an executable file. 
-Disable all macros when viewing office documents 
-If you must open the attached file, view the file in a separated network or in a virtual environment where the network is disconnected 
 
 	 
	 
 
 . 
 

¡¦ 
 
Inserts a link in the email to induce access to malicious sites. Access to malicious sites can lead to malware infection due to browser vulnerabilities. An attacker prompts access to Internet Explorer, a browser that is no longer supported. 
Response Strategy 
-Refrain from using Internet Explorer, for which Microsoft no longer provides security or technical support 
-Keep other browsers up to date with regular updates 
-If you must click a suspicious links for work, open the link in an environment separate from the internal network 
 
 .
¨B..¡ã.
  
 !
	  
 .
 
When accessing a malicious site by clicking on a link, the script inserted by the attacker redirects the victim to a site that distributes malware, and the victim is infected. Because this works only when connected in a certain IP band, malware is distributed only to certain targets. 
Response Strategy 
-Refrain from using Internet Explorer for which Microsoft no longer offers technical support 
-Keep other browsers up to date with regular updates 
-Restrict access to sites that are not trusted by the internal network 
-Install anti-virus software and enable real-time detection 
 
 "#
$¡¦.
.%
 

  
It was found that most servers that were abused as malware command & control sites were infiltrated through SQL injection vulnerabilities or file upload vulnerabilities. After obtaining website administrator privileges through SQL injection, the attacker uploaded the web shell as a file upload vulnerability to secure access to the server. During file upload attacks, the .cer extension, which could run scripts on IIS, was used the most. The figure below shows an actual post by an attacker who uploaded a web shell by exploiting a file upload vulnerability. 
Response Strategy 
-Apply secure coding to prevent SQL injection when building web pages 
-Add extension filtering at the server-wide level so that only picture files (.jpg, .gif, .png, etc.) can be uploaded as attachments to a bulletin board. 
-Make the file upload path an absolute path to prevent it directing elsewhere through the attachment file name. 
-Remove the execute privilege to prevent running scripts on file upload paths 
-
Install web firewall (Free KISA firewall CASTLE:https://www.boho.or.kr/download/whistlCastle/castle.do) 

B.
 Execution 


 
 &"#¡¦
 
It is not easy to infiltrate a company that has a high level of security. For this reason, attackers use spear phishing emails to lead employees to watering hole sites or directly execute malware. Attackers mainly sent phishing emails to the sales team or customer management team members whose email addresses are publicly disclosed on the company website. 
Response Strategy 
-Check the extension of the attached file and prevent executable files from running (.exe, .scr, etc.) 
-If you must open the attached file, view the file in a separated network or in a virtual 
environment where the network is disconnected -If you must view a suspicious file for work, install a viewer to view it 
-Carry out continuous security training for users (sales team, customer management team, etc.) who most constantly communicate with those outside the company 
-Restrict installation of unauthorized programs on work systems 
 
 "#¡¦
	¡¦	$. 
Remote control malware executes additional processes by calling the CreateProcessAsUserW, CreateProcessW functions after receiving commands from the C&C.. 
Response Strategy 
-Install anti-virus software and enable real-time detection 
 "#¡¦
	¡¦	 '¡¦'''#¡¦. 
Additionally installed malware is registered as a service as a DLL file and executed. 
Response Strategy 
-Install anti-virus software and enable real-time detection -Apply policies to block unnecessary command execution(using Applocker) on critical system 
resources on critical system resources	






	
.¡¦.¨B¨B....¡ã.		
. !"#¡ã 
 
 ¨B
"#¡¦
  
Additionally installed malware is registered as a service as a DLL file and executed. 
Response Strategy 
-Monitor the installation of services(event ID 7045), launching of new services(event ID 7036), and error logs (event ID 7030) in the system log to identify abnormal services. 
. (
 '   . ¡¦
  
An attacker uses Windows Management Instrumentation(WMI) to collect a list of anti-virus software currently installed on the system. 
Response Strategy 
-Consider disabling if the system does not use WMI 
 
 .'.
 . ! 
The attacker executed commands to the infected server mainly through remote-controlled malware. Below are the commands that were used obtained through server analysis. 
 	 	
  
 
  


 	 
 

  		 	 

  
  	  
	
  


  	 
	
     
  
  
 	
. 
 
.	.¨B¨B .. ¡¦ 		 	 

 . 	.¡ã. !"  .	.¡ã#$ " ....%$&' 

 (% ' ¡¦
   

 % ' ¡¦.	

 	 	 

¨B 
  ¨B%)¨B ' 	¨B 
%*   ' ¡¦$$	 ¨B
  
¡¦+,-	
,
./,
,..0(¨B

 %)¨B 	*	 ' 
¡¦¨B		 	 
 
%)¨B 	*	 ' 
	
 	 
-Block unecessary command executions (through services such as AppLocker) on critical system resources 
	

		
					.¡¦..¨B.¡¦¡¦.¡ã
	.. !". 
-Record and monitor commands executed through the Command Line Interface through the logging program. 
 
C. Persistence 
 )'¡¦ '   (.	  
Web shells were inserted to secure redundant access to web servers that are being abused as C&C. The webshells used primarily by attackers are ¡¯Redhat web¡¯ shells, ¡¯WSO¡¯ web shells, ¡¯Venus¡¯ web shells and ¡¯Code Hunters¡¯ web shells. The password used to log in to the ¡¯Redhat¡¯ web shell was'1234qwer' and 'venus' for the ¡¯Venus¡¯ web shell. 
Response Strategy 
-Identify and check suspicious files created at the time of infiltration. 
-Remove execution privileges from the upload file path and monitor files created with specific extensions (.asp, .cer, .html, .php, etc.) 
-Recommend regular use of the web shell detection tool Whistles (provided by KISA)  (Whistl download link: https://www.boho.or.kr/download/whistlCastle/whistl.do) 
 
 *¨B
 
If a malware is registered as a service, the malware automatically executes upon reboot. 
Response Strategy 
-Monitor the registration of new services(event ID 7045) in the system log to identify abnormal services. 
 )
¡ã)¡¦+¡ã ,%' 
When a malware is created in the startup program path, the malware automatically executes at each reboot. 
Command to check malware registered as a startup program 
0(1¡¦+,2
 
 ,%2
  ',!..*,3	 .,4	 
	,-	 
,4 ,&	.
 ,.,50(1 
Response Strategy 
-Monitor the startup folder path and programs registered as startup program 
$%&%'&#( )%*"((%+ (,% 

%- 	
%!( %. 
,( %!(%¡ã 
 
D. Privilege Escalation 
 "#

 !$
¨B
 "
 
The attacker The attacker attempted to escalate the privileges by executing a file created with a tool using CVE-2014-4113. which is a Windows privilege elevation vulnerability. An attacker remotely connects or attackers drive and copies malware to the infected system local drive. Based on the folder names classified on the attacker's drive, it is assumed that the vulnerability was primarily used to attack the Windows 2003 server. 
   
 	  
             .	 ¡¦
 ¡¦  
 
n+, 		¨B
 ,/77.8¨B	,¡¦9.:/7;<:<;;.0( 
.+,000,=	8>8¨B 
,.0. 
	
 	 
-Monitor application crash logs as elevation of privilege may result in errors /!0"/%.
,("((% 

%-	
%-1+¡ã 
-Keep operating system up-to-date 
-Install anti-virus software and enable real-time detection 
 -¡ã&¡¦ . 
The attacker attempted a User Access Control(UAC) bypass using an open tool called UACME. 
   
 	  
            .	 ¡¦
¡¦  
  
n+, 		 ¨B
,2!¡¦4.,#	-8(?@0( 
¡¦+,2
  
,000,!..*,#	¨B, 0( 
n+, 		 ¨B
,2!¡¦4.,!../8.:;;:;?0¨B¨B 
¡¦+,2 

,000,!..* ,#	¨B, 
0 
Response Strategy 
Monitor application crash logs as elevation of privilege may result in errors /!0"/%.
,("((% 

%-	
%-1+¡ã 
-Keep operating system up-to-date 
-Install anti-virus software and enable real-time detection 
 
 *¨B
 
Malware has SYSTEM privileges when executed using the service. 
	
 	 
-Monitor registration of new services(event ID 7045) in the system log to identify abnormal services. 
-Disable the administrator account and enable the administrator group account User Access Control (UAC) 
 
E. Defense Evasion 
  .¡¦'
  
2(( 	, (3((0 	(3345((
,(4-	
	 (34-	  	(3
,(4! 0#
 4 
 (
	6,		  
.. ¨B
¡¦. 
 
	 
$%-	  
%!0#(% 
 (  
$%-	
%!0¡¦7%
	(  
4 
.	  $%-	
%!0#(%8.  


  ¨B
  $%-	  
%!0¡¦7%8.   
$%-	
%!0#(%((,
  	33  
$%-	
%!0 ¡¦7%((,
	 33  

4
. 	5 $%&%'&#()%*"((%+
(,% 

%-	
%!(  ¨B
 
%.
,(%!(%9((: 
4 
. 	- 
$%-	
%!
("6
%"
3
(	 %>?2';<¨B@A=) 
	 
 .¨B
 
4 
.	  .. 
n%2

3%?(33....%#7.7...78?(33%(33	 (C¨B: 
.	. 
n%2

 3%("33 3
( 	2

 3..%	333 (	 

3C¨B: 
4 
.	 	
.	. 
	
 	 
 

3,(	 
((( 
(6	
,( (3( $%-	
%!0 ¡¦7% $%-	
%!0#(% $%-	
%!
("6
%"
3
(	 % $%&%'&#()%*"((%+
(,% 

%-	
%!( %.
,(%!(% 
 
 . '
)¨B / 
-	 
( 	(((33	 . 
(3(
 30(	D 302 	((
	 (3(
E: 

04(( (	
	3 
((302 6 		( 	3,  
63
 ,
 	 ((  
    	 
		 
  . 	
¡¦ 
	 : F 	3$%-	
%. %GHF/F7HI.F	 ,.J¡¦K  
	
 	 
+
	 ,3(6(,
 3
,3
,463
,4 ¡ã	 
 ((30L	 
 %
.
  
2((3 		(3	3
 
	3 (: 
  (3(4(	 	3  (
 3 
,3
 3((  
		 
 ¡¦ ¡¦ 
	3$%-	
%.%G 	3$%-	
%! 
("6
%"
3
( %3
 ,%G: 	3$%-	
%!
("6
%"
3
(	%3
,%G3
, 	$%-	 
%!
("6
 %"
3
(	%3
, 
	3$%&%2MN+%*"((%+
(,% 

%-	
%!(  %.
,( %!(%N $7+& 	(3 
	
 	 
 


: 
  
(	 3( 	  	3
 ?(33(
((	(63(3 	 
  
 
 !$
  
The attacker used a commercial packing program called 'Themida' to pack malware to evade anti-virus software detection. It was also used in the filenames of some unpacked malware. 
  
 	  
           .	 ¡¦
 ¡¦  
 
n%2

3%?(33....% 
$%-?#"N-!%!
("6
%"
3
(	%>?2¡¦... 
#7.7...78?(33%(33	(:.C: 
	
 	 
?(33(
((	(63(3 	 
  
 
. )'¡¦ '  
Web shells were inserted to secure redundant access to web servers that are being abused as C&C. The webshells used primarily by attackers are ¡¯Redhat web¡¯ shells, ¡¯WSO¡¯ web shells, ¡¯Venus¡¯ web shells and ¡¯Code Hunters¡¯ web shells. The password used to log in to the ¡¯Redhat¡¯ web shell was '1234qwer' and 'venus' for the ¡¯Venus¡¯ web shell. 
	
 	 
-Identify and check suspicious files created at the time of infiltration. 
-Remove execution privileges from the upload file path and monitor files created with specific extensions (.asp, .cer, .html, .php, etc.) 
-Recommend regular use of the web shell detection tool Whistles (provided by KISA)  (Whistl download link: https://www.boho.or.kr/download/whistlCastle/whistl.do) 
 
 $.0
 .0.'
 
!
$  
*((9(3(

0
¡¦
 
(33(
 
	
(,?(,(( 
 (,(4336
	
 ((3(	6
  
	 	
   ¡ã. ..  	 
 
0(1
. 
A1B
1/AC;1.;D.)0.  0(1
  (.
 A1B
 1/AC;1.;D.)0 . 
	
 	 
?(33(
((	(63(3	 
 
 
 1.!¡¦'%
.!
  
+


3(3(:(0	3
0 
	
 	 
?(33(
((	(63(3	 
 
 
F. Credential Access 
 .' 

 %
' 

 !
 ¨B'
 !
 
*(,
	04((
33
,
 (
 :
	3( : 
  ">  3 (	    34 (	 (	  "> 
 
33 (
 
 (
 
6 * 
33,(
 
 (
 4(
	 ( ( 		(		
(	(3((330 
  .	 ¡¦
 ¡¦  
         
 	  
 
n+,E=5,-=8F &,*	 ¨B 	,%¡¦	. ' *+,	
 ,= ,=8
¨B0.. 
%G .4'%¡¦D.<?/;>H7.*>H7.',=8
¨B0.. n+,E=5,-=8F &,*	 ¨B 	,%¡¦	. ' *+,000,¨B,=	0 . 
%. -E3I.39$¡¦.'%/DJJ>./J?.<?JH7!',=	0
 . n%N69 %-6OM22.%"
3
(	%%¡¦	. ' 
"%%..
%.. : 
'!P!21 )'$J¡¦¨B.7.8>.¡¦"8>.1)%....  : "%%2
( 
n%N69 %-6OM22.%"
3
(	 %'¡¦	. ) .AO*,..%
 %:3 
'!P!21 )'$J¡¦¨B.7.8>.¡¦"8>.1)%: 3 
	
 	 
103
(, (3(
 	 + 
	,( 	(
 	
((  #	$%$$&$!%&'$(%$.&&%$!(..$$	
$
)$	'	. 
 $
¨B+¡ã
¨B¡ã '
!
 
?( 
(64The attacker stealsE!!Q ( 
  .	  ¡¦
¡¦  
          
 	  
  
n%N69 %-6OM22.%"
3 (	%%¡¦ 	. ' 
*+,
 , 	?0J8!. .., 
'!P!21 )'$J¡¦¨B.7.8>.¡¦"8>.1)% L 
	
 	 
 

(  	
 (3: 
 
  *),*-2.*$
 
  ')¡ã 
QQ #+(	 #>2#!( 

(3	0
(
,0( 6 QQ #+#>2#!.

,( 
3 
,0((
 (E((	(
	 #2Q (¡ã2((  	(

 3(33	 R+
S
 (3(( (	 
33   	(3(	(
(
 
3
(3
 
		 
  !" 
3 
.	0(.% .$&':& 
.
   %  &' 
7.;D/7/77?+<>+;7!4:%&	(:!'. #4	  	% . $&' 7.;D/7/77?+<>+;7!4:%&	( :!'	
  7.;D/7/77?+<>+;7!4:%&	(:!'  .¡¦.¨B... .  7.;D/7/77?+<>+;7!4:%&	(:!' ¡ã. . ¡¦.¨B..  !!""##$ 

#   $¡¦  %  &' 
0(1¨B¡¦+,-	 , 	*
=	,*	 ¨B ,¨B .
,K0( 0(1¨B¡¦+,-	 , 	*
=	,*	 ¨B ,¨B .
,K0¨B . 0(1¡¦+,-	 
 ,	* =	 ,*	¨B	,¨B	.
 
	
 	 
 

( 
&".A¡¦AA(	.¡¦J
 ?(33QQ #+#>2#!!

,"  

-	
3 
,?"¨BC8J4J.¨BA 
 
G. Discovery 
 %
 '.
¡ã.
 ¨B¡ã 
2((	(
 ,(T10,E
((,(,3(	
3	
 (
  
(0(	  
!" 		 
 
..0(.=%.¨B' ..0(.( 
	
 	 
103(	 

(,
 #	$%$$&$!%&'$(%$.&&%$!(..$$	
$
)$	'	. 
 
 --.
 ¨B¡ã.
¨B.. ' 	
¡ã 
2(( 	(
(3
,( (33	E>
,M
0UE
		 60#!

 
33  6
6  ((	
0
(
 
!" 		 
 
>
,M
0U0(
	 %#	.)¨B'
	L/9   )¨B .; 
	
 	 
> ( 
 ,6
6(
  3
	,

(36(
4	  
	(
  
 
 
 ¡ã2
.
 ¨B¡ã 
"
0
0 
	 	
   (
 ' .	 
  
	
 	 


 
(	(	(( 
 ¡¦
¡ã!.
 ¨B¡ã 
*(  -	
 ((, ?(
 - ?¡ã 
 	
0 (33	 ( 
( 
  
.+		 ,¡¦/ M +¨BK)	! &	 &	.
 +
 .¨B   
	
 	 
+ 	(63,0 	

 -? ?(33(
((	(63(3 	 
  
 
. 3¡¦¡ã)
¡ã 
2
(33(3(	
 (3 (4
33:,3(	3 ,
 
%'. 
  .
 
FI#4,G .4,¡¦¡¦ 		¨B,
N% ' FI#4,E) -!3.,4	
	 ,-	 
 ,¡¦9
 	,	 
 N

 
	
 	 
?(33(
((	(63(3 	 
  
 $.
¨B¡ã 
2
0((33	,0(	(3((,	
304(
 3 
	 	
   $'  ¡¦
 . 
0(1
 ¨B 
 
A1B 
1/AC;1.;D.)0. 
	
 	 


 
(	(	(( 
 
 ¡ã1 ,&.
 ¨B¡ã 
$
33(

 (
 
 030(	60(( 
 ) *
  $.  		
 
0(1  A1B 
1/AC;1.;D.)0. 
	
 	 


 
(	(	(( 
 ¡ã . !
.
¨B¡ã 
$
33
 (
 
0306,(	60(((
 .	  	
 $.  		
 
0(1
  	A1B 
1/AC;1.;D.)0. 0(1	  A1B 
1/AC;1.;D.)0.  0(1A1B
1/AC;1.;D.)0 . 
	
 	 
 

 
(	 (	(( 
 
 ¡ã*. !
¡¦
 .
 ¨B¡ã 
$
33

,(
 
 (
 
0306,(	60(( 
*. '
 $. 	 	
  
0(1.	.¨B¨BA1B 
1/AC;1.;D.)0. 0(1.:A1B
1/AC;1.;D.)0. 0(1¡¦+,- 
,
 ./, 
,.. 0(¨B
 
 A1B 
1/AC;1.;D.)0 . O*
 		¨B
		
=.	
P 
	
 	 


 
(	(	(( 
10 ¡¦ .
 ¨B¡ã  
$
33(
33
(
0(	(

 (
 	(3 
 	 
 $. 		 
 
 0(1
A1B
1/AC;1.;D.)0 .  0(1 
! 
	A1B
 1/AC;1.;D.)0 .  0(1 
!
 	A1B
1/AC;1.;D.)0 . 
	
 	 


 
(	(	(( 
 
11 )¡ã .
¨B¡ã.
¨B'
!! ¡ã 
  	 
$
33(3
	0
( 
 
*. $. 	 	
  
0(1A1B 
1/AC;1.;D.)0. 
	
 	 


 
(	(	(( 
12 ¡ã¨B
.
 ¨B¡ã 
$
33	(3	
 (
 
30(33	0
 $
¡¦ 	 
 $. 	 	
  
 0(1 
  
..A1B
1/AC;1.;D.)0 . 0(1
. 
A1B
1/AC;1.;D.)0.  0(1
  (.
 A1B
 1/AC;1.;D.)0 .  0(1 
 %QRST'A1B
1/AC;1.;D.)0 . 
	
 	 


 
(	(	(( 
 
 13 ¡ã*.
 .
¨B¡ã 
$
33
 

 ((	 

 (
 
0 
*.  
 
   	
 		 
 
0(1
.	.¡ã. !"A1B 
1/AC;1.;D.)0.  0(1
 .	.¡ã#$ "A1B
1/AC;1.;D.)0 . 0(1


 	A1B 
1/AC;1.;D.)0. 
	
 	 


 
(	(	(( 
 
H. Lateral Movement 
 (
''
  	.!¡¦	 
 (
 ' 
 


0
(

 ,(3
 ( 

33	60	 0 
	   + .	 		 
 
:0(1
,,%&%.
'%(+)**%+A1B
1/AC;1.;D.)0. 
	
 	 
&( 	(
 	
(0 "(63
 ( 
( 	( 
( 
 ?(04 	(63 	(3(,  

 03
 ,E3 
, ?"A¨B.4¨BC7¨B¡ã
  	0(6
(33
 ,   	
  		 	     	
  		  	     	 . 
 
I. Collection 
 .!¡ã 
>3 
(3 

 (
(
 
(((( (3(	 330 

'. 	
 ¡¦ 
*H
 .
 O$*N&

 	N&	 N*H P   	.  

  	 	 
-=

 .
 ¨B -=
  
E.U 	¨B . .¨B	 	 	 	 *
 ¨B . 3.¨B  . 
E.U		 	 
E	 
   &
	¨B	 	  H
 
 
.¨B
 3	
 	.¨B.	 
¡¦¨B¨B
 3	
¨B
 ¡¦	:;>¨B 	 
 
3
 

 
)	 
¨B
 E¨B 		 	¨B¨B  
4¨B¡¦/

 	¨B
 :¨B	 	 
Documents on actions in case of unauthorized insertion of Iframe 
-=¨B . H	
¨B	. 
#	. 	 
)¨B
¨B	. 3
 .	 ¨B	. 
	
 	 
! 

(
((30(	((
	 #	$%$$&$!%&'$(%$.&&%$!(..$$	
$
)$	'	. 
 
 .!*	 '.
¨B 
*((
 33 
(
 
(	0((S 	
  	((
 	2 	
 3 (EnE4(	
3 	
  
(( 3303(	( ((,	((30
 
  .
  
  .	 
  
  %	$ 
n%N69%-6OM22.%"
3
(	%'$
#()'!P!21 )'.$.K"JCC>8AK.K.C)% n%N69%-6OM22.%"
3
(	%'$
#()''$
#(V)'¡¦17¡¦*7A.7A¡¦¡¦7..J)% n%N69%-6OM22.%"
3
(	%'$
#()'!P!21 )'.¨B.1¡¦*A¡¦$.C.C¡¦J$)% n%N69%-6OM22.%"
3
 (	%'$
#()'!P!21 )'.$A7>¨B71>1A$*.¡¦A)% n%N69%-6OM22.%"
3
(	%'$
#()'#12-N+W!1+U?$1)'7JAA817A.1¨B.A>.*)% n%N69%-6OM22.%"
3
(	%'$
#()'&#()'¨B*.8$.JK.$J7$¨B.8)% n%N69%-6OM22.%"
3
(	%'$
#()'!P!21 )'$J¡¦¨B.7.8>.¡¦"8>.1)%XY% n%N69%-6OM22.%"
3
(	%'$
#()'!P!21 )'$¡¦.CC¡¦J>K7.8A.A$)% 
	
 	 
"(63 (0
(,(	 

 (,  

3 
	
 
( 
 .'''
 !
 
!(,3
:,(3(
(	
(3 
	 	
 !"
	¡¦ 
 0(%¡¦	  	('A.;D.)0. 
	
 	 
: 4	 	 

 .	 
  ¨B . ¨B
  O0.P   .4&     ¨B 

   
	 	  (	
 ¨B
 :$
 ¨B¨B:

	 =¨B¨B: 	  
 
J. Command and Control 
.Standard Cryptographic Protocol: Remote control malware uses RC4 algorithm to encrypt data Multi-Stage Channels: Attackers use various C2 points to deliver commands to malware  Connection Proxy : The C2 server of malware acts as a proxy to perform remote control Remote File Copy: Remote Control create and exfiltrates files from C2 through command 
Custom Cryptographic Protocol: Downloaders encrypt data using custom encryption algorithms  Multilayer Encryption: Downloaders use HTTPS and custom encryption algorithms 
 Data Encoding: Base64 and XOR for remote control, and custom encoding for downloaders. Data Obfuscation: Malware obfuscate data in ways such as encoding, encryption, and custom 
	Commonly Used Port: Malware attempts to control commands using HTTP(80) and HTTPS(443) 10 Standard Application Layer Protocol: Malware attempts to control using HTTP, HTTPS
 (3(
(3


3(	((3
 6(
 (
 (
 
(	(, 
:
,(3
 ((0(
	,40 
4(	
6(
  

		

¡ã 
	
 	 
"(63 (0
(	 
 (, ?(33(
((	(63(3 	 
  +  	 
   
 .(	 (30  3 
0
 (0S(
 
 
	0(
(3 
 
K. Exfiltration 
   	
     	
       	
   . ¡¦  .2 !
4

 )'
¨B
' ' 
56+-	¡¦ 
  
     
   .   ¨B..¡ã.n¨B! "	  #. 
 "#  1¨B. ''..	  #!
 !
 .7	 . "#  1¨B
¨B$ !
 	¡¦	  
 (3(	(		((,
	,40
4(	

36( 

		

¡ã 
	
 	 
?(33(
((	(63(3 	 
   




 
  
:	L(  + $	 
   
  .(	 (30  3
0
 (0S(
 
 
	0(
(3 
L. Impact 
 .. ¡¦
)¨B
 ''  
!
	¡¦	'	 	¡ã.¨B'8 
2
  
3 (		3 (3(	(	 
(	 : 
 3360
 	  
0 
((30(	 (	  	 
 

		

¡ã 
	
 	 
+ 
	,3(6( 

(3 ?(33(
((	(63(3 	 
  
 
4. Malware Analysis 
The types of malware and normal programs that an attacker used to carry out an attack are as follow. The attacker used the ¡¯net use¡¯ to copy and execute files with the attacker¡¯s drive connected remotely. 
"'&()*	.¡ã+	.'&,¡¦ 
.. %¡¦ ¡¦ .
 ,. ¡¦ 
  
 %	 $ 
. intrusi¡ã. . " 
! 
on 
#  
 	 
  
" 
$. 
. %¡¦ . &'. . 
n.)*+,. ./01
 2.!!  2 
(¡¦ 	. 
n.4

.&.567
.89¨B.:"2
;5 n.4

.&. .5 
3
. 1. 
n.4

.& ":."::.<"9.9.".:"9="& ."!"5675 
!  ¡¦ 
n.4

.&.57>.?¡¦
!.¡ã03@":."::5 n.4

.&":."::.<"9.9.".:"9="&."! "7>5 
3
 
. . n.4

.A'/%57>5
3

.  . n.4

.A'/%5675
! !  n.?	;¡¦.$	¡ã44'.3

. B CBD@¨BD8E.//.8%@%9%C.A'/%5675 
(!
. 
/5¡¦. " 
¡¦
!!
¡¦

 
4

 3AA. &;¡¦
 
n.4

.31 
4

:..! 

7>5 
4

 F2. ¡¦¡¦ 
n.)*+,. ./0"9.9.".¨B"./ .'
527>  
/¡¦ 4

 
n.4

.9..¨BG
.%/"9.:>">::¨B5 
G 
/¡¦ 
4

 
n.4

.HE%1/.A
$5675 
G 
4

 
02. 
 
" 
$	.  
$	.  
n.?	;¡¦.$	¡ã44'.3

. B#I#4/1CB6>./¨BE.¨B%:767¨B8%C.8978:::9¡¦ 
/G 2 
D.  ¡¦ 
n.4

"0  2.¡ã 5./G25 
%
¡¦. ¡¦ 
n.4

"0  2.<4A1(
  .(
5

(
  
 
n.4

"0  2.<4A1(
  .(
¡¦
 
@
 .
@
 
n.4

"02.@

2.	

2G"57>.@
¡ã
25 
¡ã
2 ¡¦¡¦. 
2 
 
1. Initial Infiltration 
A. HWP(Hangul Word Processor) Malware 
When a user of a Hangul Word Processor program which has not been updated since February 2017 ope ns a HWP file containing malware, the recipient is immediately infected with malware and can be remotely controlled. To this end, attackers evade suspicion by including a message in the email body and planting malware in HWP files disguised as applications, additional documents, etc. 
When malicious HWP documents are opened, malicious behavior begins from the exploit codecode at BIN0001.ps in the BinData area of the HWP document. The remotely-controlled malware is then injected into the ¡¯explorer.exe¡¯ and operates in memory. 
(-.+*&#/	 ¨B  
 
BIN0001.ps reads the memory of the hwp.exe process and searches for two specific data (0x8B68B727AEBDD87E and 'F0und3q9') within the BIN0002.bmp file. Based on this value, 32-bit and 64-bit remote control malware data encrypted with AES128 are then read, decrypted and executed according to each operating system environment. 
(!-.+*&#.	&¡¦+ 
 
B. Watering Hole 
The attacker disguised the body of the email as a request for a quote on a product and sent a spearphishing email to the sales representative. In order to carry out the attack, the attacker encourages the victim to access certain homepages using Internet Explorer, presumably because Internet Explorer is no longer updated, and the attacker is taking advantage of already disclosed vulnerabilities. 
It was confirmed that the final remote control malware was downloaded due to the watering hole attack over four stages.. The roles purpose and URLs for each stage are as follows. 
"'&(!.	-&		.+ 
 
'  ..  .    	 )%&  
*  	 .  
;  .. 
.  	¨B  B<
!. C¡¦
!  

%	¨B
'V
 
9$& 
B<
!. 9C¡¦
!
¡¦	¨B .=687 
/ 	.. 
 
923#  
4¨B
¨B¨B  
.   	¨B 		¨B BE¡¦J. GC¡¦
!>>¨B
5.=687  
	%	¨B
/'  ¨B  
%!V
  
<  *
=  ¨B  "  

'  

In the first stage, spearphishing leads to access to the modified main page in stage 2. Subsequent IPs are then redirected to the page in stage 3 only if they are accessed from the target IP band. The malware that injected into the IIS-related service, w3svc, to control HTTP packets is running on the server hosting the homepage in stage 3. The ¡¯sublist3.asp¡¯ does not actually exist and the malware receives it instead, which is used for protocol, domain, port, page, and parameter verification. If verification is successful, additional malware will be downloaded from the server deployed by the attacker. It was confirmed that at the time of the actual attack, the attacker maintained the modified main page in stage 2 for only three hours after sending the email. of the second stage of the modulated main page after sending mail. 
 
(0.	.&¨B 
 
The main page or JavaScript files shown below were modified and a malicious script inserted in the normal sites exploited in watering hole attacks. There are three types of malicious scripts obtained through analysis. 
"'&(0. 	.&¨B ¨B 
.. ¨B   
-. 	¨B.. .; O3un additional script) 
-. 	¨B.. ./ O9 $&3P 
-. 	¨B.. .. O3 P 
 
2. Maintaining Persistence 
The malicious code used for the initial compromise installs additional malware through a command so that the malware is executed even when the computer reboot. The additional malware can be executed e ven after through the startup program, registry, and service registration. 
A. Dropper 
Dropper malware performs two functions depending on the options. [-s] option and [-g] option have two functions; collecting/transmitting service list and dropping and executing remote-controlled malware are performed according to each option. The [-g] option receives two parameters and the [-s] option receives five parameters. 
((.¨B¨B*&#/	¨B	  
 [-g] Options : Gather registry information 
The [-g] option gathers a complete list of services from the netsvcs group within the infected system. The n, the malware returns a list of services that are not currently used in the system, and the attacker selects one of these service names and uses them as a parameter in the ¨Cs option. 
(1.¨B¨B*&#2¨B 	 
 
The [¨Cg] option is executed by the initially installed remote control, the actual command executed by the attacker is shown below. 
(3.¨B¨B*&#2¨B	/	  **¡¦ 
Malware collects a complete list of services existing in the netsvcs group, compares them with the list of services registered in the current system, selects a service name that is not in use and then uses it as the service name of the malware. The list of netsvcs group service names varies by system, and each registry location is as follows. 
"'&(()	 ¨B 	.$¡¦ 	..¨B 	 
%¡¦ .
 
# 	

. 
 
¡ã0A1.#I#4/1.%%

#.# G¡¦K. B# G¡¦<!C 

 
 #
 	¨B¨B 

  	   
¡ã0A1.#?D4$E(/.1¡¦

 .$
. <4.% 
 .#G¡¦
K. G¡¦ 
.	. 
 [-s] Option : Drop and execute remotely-controlled malware 
Dropper malware has three types of resource encrypted with RC4. First, using the RC4 key received as the 5th parameter, the C2 List resource is decrypted and created into a file. Subsequently, the injector resources are decrypted and registered as a service using the 3rd and 4th parameters. The remote control resource is saved as a file in an encrypted state, which is decrypted and injected into the ¡¯svchost.exe' when the injector is run. Finally, remote-controlled malware attempts command control by reading the C2 List file. 
"'&(1) &	&¡¦¡¦¡¦¨B¨B 
% $ 
¡¦
	 
.. 
%¡¦ 
;@7 
.>;0 ¡¦/#
  
¡¦C¡¦
 
¨B 
( 	:¨B 	.	 ;@; 
%<&  '0¨B¨B 
$5	 
Decrypt and load perfcon.dat file 
;@/ 
.	0 
3 			¨B 
3.>;0¨B		¡¦/
 
 
(4.¨B¨B*&#2¨B	/	  **¡¦ 
 
 Resource 160 : perf91nc.inf (C2 List) 
Resource 160 is a file that has a C2 server list and set values required for execution. Remote-controlled malware reads this file and attempts to connect. The file size is fixed at 0x2EE0. 
"'&(3¨B$56$&	 	 
+ -
¡¦ %¡¦ 
7(7L7(D $* 
$W 
$* 7(@/7L7(;!@) 
¡¦/..¨B  
¡¦	 C		¨B..O (;7P 7(;!D7L7(/.H) 
&	 

N	  	¨B 
*¨B(	.	
  	¨B=O (;7P 7(/.¡¦7 
)¨B. 
¡¦	  		¨B¨B(	)¨B. 7(/.¡¦¡¦
  O	P 
4¨B    	(   7(/.*7
  O4P 
4¨B( 	¨B 7(/.*<
  O4P 
4¨B 
   7(/.*? 
)¨B. 
)¨B.   ¨B    
4th
 Resource 161 : [ Parameter].dll (injector) 
Take 4th Parameter of the file name associated with the service name of the unused netsvcs group found through [-g] option and create that name as a file name. To disguise itself further, the malware finds the ¡¯svchost.exe¡¯ where the netsvcs service is running and injects data decrypted from the perfcon.dat file. 
"'&(47$&¨B 	.¡¦ 		  	¡¦' 	(6¡¦&&$&
 
' 
$ 
#	.¨B. 
¡¦+,-	
,  .,

8¨B¨B0¨B	. 4¨B	 
 
¨B	. 
000 3 	:		¨B¨B ¨B 
X3¨B#	E
 +;+; 
5	 
 
(8.	 &¡¦¨B$9	 *&# 	 
 Resource 162 : perfcon.dat (remote-controlled malware) 
The remote-controlled malware is described in detail in 3. Final remote control. 
B. Downloader 
When an attacker executes a downloader malware, the attacker executes it by giving the encrypted download address and the path to save the downloaded file as a parameter. Although KISA did not obtain the malware that ultimately was downloaded, it is assumed that it is the same remote-controlled malware dropped by the the dropper malware. An attacker can select or mix one of the droppers or downloads to maintain persistence. 
(5.#&¡¦*&#/	¨B	  
 
 Data encryption and decryption approach 
2nd
Decrypting an encrypted string given as a  parameter extracts the primary and secondary download sites to be accessed by malware. The attacker then collects information from the infected device and proceeds with encryption in the same way. Encryption keys are generated randomly each time, and S-box borrowed some tables from existing DES encryption algorithms. It is estimated that certain algorithms are used through customizing, and overall there is a general symmetric-key algorithm structure. 
(:.#&¡¦*&#¨B 	¨B¨B. 
 
 Sending device information and downloading additional malware 
Downloader malware first connects to the primary download site and sends information about the infected device along with the address of the secondary download site. Both the first and second download sites consist of specific ASP pages. The primary download site connects to the secondary download site received from the malware and transmits information about the infected device. In the secondary download site, the malware checks the target based on the information of the infected device and sends malware encrypted by the ID and computer name of the infected device. If it succeeds in downloading final malware normally, the malware executes by giving a string called CloseEnv as a parame ter. 
(¡¦¡¦	&*&#¡¦#&¡¦¨B 
 
Each time data is sent to the primary download site, it is delivered in json format, and the structure is as follows. Encoded secondary download address, randomly generated key, and encrypted data are always sent. 
(!	 	$¡¦¡¦#&¡¦*&#¡¦  
The encoding methods used by malware to transmit secondary download sites are as follows. Using a specific table, the malware is exchanged with letters in a random location, and added together to produce a string. 
(0;/*¨B&$¡¦¡¦#&¡¦ 	 ¡¦*	.¡¦ 
 
Information on infected devices collected and leaked by malware is as follows. It collects more information than general malware, such as available memory, product type, etc. The unique ID values given at each stage of malicious behavior are added first, and the hash values calculated as XOR are added last and then sent. 
"'&(87	$$	¡¦¡¦¡ã$*	  && 	¡¦'¡¦#&¡¦ 
.. $

 
$* $*= ¨B	 
  
 . $;@= 	$* 
¡¦	.  &	
 
	   = 	.	
 
	
 

  	 	 
     .	  
E	 	 45	 	  4	
 	 H¨B
  &	. $
@<= 
4	   U   ¨B     ¨B.¨B=¨B  
U 	¨B 
¨B¨B      
	 	      

E     	 
¨B¨B:
  
	 	 ¨B	 
¨B0(¨B
 	 

 *YE3  
Malware uses specific hexadecimal values to distinguish between the malicious activity stage and execution mode. One of the characteristics of malware is that it supports two modes to connect; first it connects through WinHTTP, and in the event of failure it connects through WinInet. 
"'&(57	$¨B$./¡¦*&¡ã& 	.¡¦#&¡¦ 
-
¡¦ ) ¨B
 ' 
Send infected 
 
	 	N.	 N
	 7()7D*@H.< 
device information 
	 ¨B	
 
7(.)?¡¦7*J; 
3  ¨B 
¡¦	 ¨B  
$*N.	 N
	 	¨B	 7(¡¦HD>7!/J 
.	 

 ¡¦	 ¨B 7(*DH/7!>@ 
(	 -F  &!&$ 
)
 
. -$ N ¨B	

 
 	 	7(J>?@.)7> 
 
.	¨B 	N	
W ..	 	. 	 $¨B
  		
 
..	
	.
  	
  7(!>.<?HJD 
-$!&$ 	 .:¨B¨B!&$ -F & 
 
 Download site 
Both the first and second download sites work as ASP pages. Although the first download page was successfully secured, the second download page was already deleted at the time of analysis and was not available. The first download page has two modes: the mode used by malware is translate. Redirect mode has a simple function of redirecting to the URL received as a query. 
"'&(:<¡¦ ¡¦'¨B*¡¦#&¡¦¨B 
¨B  
 
¨B %. 
 
¨B 
Q( 	(((	 3
(	 (3( 
.N!2 (3( 
 
.(,  
Z12 #* 
Translate mode decodes the value received from the malware, obtains the secondary download site address, and attempts to access it. It sends information about the infected device to the secondary download site and returns malware to downloader malware. On this page, the same table that the downloader malware has is used for decoding. 
 ((+*¡¦#&¡¦	  ¡¦=¨B 	&> 
 
3. Final remote control 
We named the final remote control malware used to control the infected system as ¡°bookcodes¡°. This is a string that is mainly used to check the status as the malware communicates with the C2 server. 
A. Remote-controlled malware "bookcodes" 
 Types to manage C2 list 
Although the way C2 information is held varies depending on how it is executed, the malware has the same update function. 
(?! ¨B¡¦	*	.¡¦'* 	&&¡¦*&#
 
' .
 
 ¡¦ /  ,. / 
 	  
$¨B  4¨B	
 F-&  
	   	   	¡¦/        
2.      
4  
.
 
  *	..  3.>;0
        

 Save Log 
Unlike remote-controlled malware installed by droppers, when installed for the first time by HWP documents, logs for each stage of malicious behavior are stored in a specific file to determine whether it has been executed properly. 
(!+ 	.¡¦ 	 	$&$&	¡¦'*	 	&&¡¦*&#
 
' $ 
#	.¨B. ¡¦+,-	
, .,
8¨B¨B0¨B	. 
4¨B
 ¨B	.   000 

 	 		¨B¨B	 ¨B . ! XE$	000 
 String Encoding 
Some strings used in malware are all XOR encoded. The source value and offset value and 0x33 are XORed to extract the source string while repeating the entire length of the string. 
 
(1 .¡¦*&#	¡¦* 	.¡¦ 
 Data encryption 
RC4 encryption and base64 encoding is applied to data used in all communications, such as the system information list collected by malware or the results of commands, and commands received from C2 servers. 
(3;/*¨B&$'. ¡¦*&#¡¦ 	 ¨B	*	.¡¦ 
 
 Collect and send information on infected devices 
Upon initial execution, malware collects information on the infected system and sends it to the C2  server as follows. The attacker receives the information and identifies the infected system environment. The value 0x20001 is estimated to be to a value to distinguish between versions of malware. 
"'&(0$* 	$	 ¡¦¡¦¡ã &&	¡¦'*	 	 &&¡¦*&# 
.. $

 
#.
 	 ¨B¨B.  $ 
$?= 	$*  . 
¡¦   
 .(	 ¡¦	.  
&	

  
  $	 	 #	¨B$& 2
   ¡¦  (  
    
E$	 	 4  $	 	 4¨B
   E  .  E 	 U 	¨B 
¨B¨B 7(/777;    . 	   
The data structure for sending information on infected devices is as follows.  
(4. 		 	$¡¦$*	 $ 	¡¦¡¦¡ã   

 
 Receive commands and send results 
The following is the command structure that an attacker sends to gather additional information through malware and to inflict additional malware infection. 
(8. 		 	#.¡¦ **¡¦ 
 
 Remote Control Full Commands The remote control behavior by the entire command used by the malware is as follows. 
"'&(()*	 	 &&¡¦*&#$&& **¡¦  
  		
  $  		  
  $  
7(>D?J.@<@  ¡¦ 	¨B¨B	 	 		   7(>D?@.@J<   =	  
7(>D?J.@<D  *	¨B .  7(>D?J.@JJ  ¡¦ 	¨B¨B	 		.	
   
=.  
7(>D?J.@<?  ¡¦	. )¨B .¨B	  7(>D?J.@J@  

  	 	  
7(>D?J.@<>  *¨B¨B  7(>D?J.@JD     
 O¡¦/	 	N 
 NP  
7(>D?J.@<!  ¨B  7(>D?J.@J?  ¡¦/
 
.  
7(>D?J.@<H  *	 ¨B 	¨B  7(>D?J.@J>  ¡¦	  ¨B     
7(>D?J.@<*  2.¨B 	¨B  7(>D?J.@JH  ¡¦.	

 
 .¨B.  
7(>D?J.@<.   .	¨B	.
 .¨B	     7(>D?J.@J¡¦  ¡¦	  ¨B  
7(>D?J.@<)  ¡¦ .	

  7(>D?J.@J*  ¡¦	  


  
7(>D?J.@J;  ¡¦.¨B  
 .  7(>D?J.@@7  ¡¦	  ¨B	¨B
      
7(>D?J.@J/  ! .	  	 

 	 
  7(>D?J.@@;  ¡¦	  	. 	  
7(>D?J.@J.  .(	    7(>D?J.@@/  ¡¦.	.	  

 
B. C2 Server 
The C2 server of the bookcodes remote-controlled malware also operates as an ASP page. The page attempts to communicate with POST, where transmission data does not remain in the web log, and is located between malware and attackers, acting as a proxy. 
 C2 Page Function List 
C2 page functions are largely divided into data transfer and log save. The biggest role is to receive or transmit data to attackers, and other functions include saving the ID values of infected devices. In addition, there is the MID that manages these C2 pages, and when a victim accesses the C2 page, the IP of the infected device and the C2 page address is sent to the MID. 
"'&(1<¡¦ ¡¦'	.?!¨B 
¨B 
 
%. ,. 	  
$	 	  
K3	( ?"(		(	 
 
!	 
(	 
$760( 		 *(  
+ 
(	360(  	 	
$7 
3 
 
3
  	 
$
33 	 	 ?"3
,3 
¡¦	  	 
!( 	 	 ?"(	 (  ?"

#	  
+ 
(	 
$7
 (3( 

 
!	 

(
 (	 
(	3
 $7 
The function of the MID page below allows an attacker to collect all the information on C2 pages and identify which infected devices are connected on which C2 pages. An attacker periodically gathers information on MID pages. An attacker can enable logging by sending 1 to the tableno parameter on initial use of the freeboard function, and only the device that is connected for 60 seconds following the attacker¡¯s request is saved. In other words, the attacker collects and confirms the IP of the infected device and C2 information only when the attacker wants wishes to, and issues commands through C2. 
"'&(3<¡¦ ¡¦'<.¨B 
¨B 
 
%. 
=	 
!	(	((  	$7(,(	 		
 (
 
$7(, 
=	  
1(63 

D 	((
	 
,D(6
(	 
*(  
 
(5<.¨B¨B	 & ¡¦=$	 ¡¦¡¦¡ã..$	 ¡¦¡¦¡ã+.?!¨B¡¦¡¦¡ã> 
 Response value when connecting to C2 server 
The ¡°bookcodes¡± malware communicates with C2 page and checks the connection status through the following values. 
"'&(4<'.'.¡¦ 
¨B / .
' ¨B$ 
=			 
+/77 
7..!  7..!  
=			 
+.77 
K(3 	 
(	(	3  
=			 
+<77
 ?"(,¨B.¨B#
K
 	 1:  	D 
=			 
+J77 
K(3 	 
(  ?"(, 
 
=			 
+@77 
 
K(3	
(	3
,3 
 
C. Remote control framework 
The entire communication structure of remote control consists of remote-controlled malware, C2 page, MID page, and the attacker. The overall flow is as follows. 
(!:%¡ã¡ã#$*		 & ** 	 
 
 Process during malware infection When infected with malware, the actual remote control framework operates as follows. 
(!)*	 	 & ** 	¡¦ 
 
 Overall framework structure 
Analysis of a number of infected victims, C2 pages, and MID servers confirmed that the remote control framework consists of the following structure. 
(!!%¡ã&&*	  	 &$*#.		 
 
4. Tool 
A. DLL injector 
Using the injector tool, check the ID value of the currently running process and attempt to inject malware into that process. Used to inject the following Proxy tool. 
(!0.779	 *&#/	¨B	  
Referring to the pre-collected process ID received from the 2nd parameter, inject the malware received as the 3rd parameter into the process with that PID. The process is as follows. 
(!(.779	 *	.¡¦ 
 
B. Proxy Tools 
When attempting a watering hole attack, the attacker used a DLL injector to the hosting server to inject the Proxy tool into the w3svc service. The malware injected into the w3svc service uses the server API because it operates on the web server, and it creates a URL group to monitor all packets and downloads the malware from the attacker's server when the request value for a specific condition enters request queu e. 
(!1+/ 	&¨B	*	 .¡¦ 
 
5. Conclusion
¡¾Defender¡®s Insight¡¿
 In this report, the Korea Internet & Security Agency(KISA) looked at the types of attacks that collect internal information using various malware and tools after initial access through spearphishing emails. The first report (TTPs#1) focused on methods of internal distribution after infection and how malware is installed. This TTPs#2 report focused on the initial access strategy, the tools used for Comprom ising, the functions of malware, and the information collected. 
Attackers used spearphishing for initial access, exploiting human error rather than risking a direct attack on a highly-secured system. Once an attacker successfully infiltrates a company, an attacker secured persistence with remote-controlled malware, collects information and spreads malware. Normal tools were also used when collecting information to avoid detection by anti-virus software. 
With these offensive tactics in mind, it is necessary to avoid accessing external sites through Internet Explorer (which is no longer supported), refrain from opening attachments or clicking links in any suspicious emails, and to contact the in-house information security team in any such cases. 
To prevent infection through attachments, make sure that the extension is not used twice or is not hidden at the end of a very long file name. Avoid opening executable extensions(exe,msi,scr,vbs,bat,ps1, etc.). 
Additionally, always keep the Hangul word processor or Microsoft office program up to date and updated regularly. Do not click any suspicious links within the body of a document. For Microsoft office files, do not open any documents that encourage enabling macro options. 
It can be difficult to prevent initial access attacks such as spearphishing, which target human error, with only a limited number of security personnel dedicated to protect a firm¡¯s employees and assets. Therefore, it is important to have measures to minimize damage and slow the pace of an attack in case of infiltration 
Defenders should be able to monitor the minimum of important systems based on their understanding of the network structure. Additionally, unnecessary network sharing among systems should be terminated and access privileges to accounts should be separated by systems. 
 
6. Yara Rule 
9)
   ¡¦' 
' 
'
!¡ã' 
!¡ã  :''
 
 ¡¦
  
!
 	¡¦	¡¦ .' 
 '.

 8- ' 	!	 22;.+ 
# 
.	 <'	'
' ¡ã 
 ! 
.	=:	! 
¡¦ .
' 
' 
!¡ã	#
  
!
!8 
¡¦ 	.¨B 
yara [rule file] [search target file or path] 
-Accurate file verification and review is required as false information may occur when using Yara rule. 
-The rule file attached to the post contains rules related to the malware specified in this report 
-To use and download: https://virustinal.github.io/yara/ 
 
. 	.¡ã	
..
¨B. 
 	
        
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B 
   . ¨B	
       ¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)$¨B 
¡¦"¡¦+ . ¨B,-$&,$,+,#./01+2,+###&$#¨B ¡¦"¡¦# . ¨B20,112#.-&+0&,1,-.$,0¨B 
" 	
 3". 4 	 .  # $$ &1 $$ $$ 50%+06 # $$ 1/ $$ $$ 7 
4"	
 3+ . ¨B8*
 '¨B 9  '" 9  4"	
 3# . ¨B  .	    
3¨B 9   '" 9
 
4 
 + .  2/ /# 02 /$ 20 /& 0/ /2 $# / 7 4 
 # .  & 20 :: 2/ & 20 :: /# & 20 :: /# & 20 :: 02 & 20 :: /$ 7 
'
	
 .  
	+&;$< .. $=02   
"
> ? /@   4	   +   ;4"	
 3A<   +   ;4 
A< 
7 
 	
      B C'	   
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B 
   . ¨B	
      B C'	¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)$¨B 
¡¦"¡¦+ . ¨B1&+111&-..&2.20+,02,.0+--¨B 
" 	
 3". 4!+ .  /+ 1+ &+ 1 /# 11 1/ 1. // &0 7 
4"	
 3+ . ¨B"*
 ' ) 3¨B 9  '" "'
 
 4"	
 3# . ¨B'-
)¨B 9   '" "'

 
4'"	
 3+ .  & 20 :: 2/ & 20 :: /# & 20 :: /# & 20 :: 02 & 20 :: /$ 7 4'"	
 3# .  . :2 $ :: 5$%/6 /# + /2 5$%/6 .. .2 $ :: :: -- -- 2+ ./ -, :: 1 .. 7 
'
	
 .  
	+&;$< .. $=02   
"
> ? /$$.   4!+   +   ;4"	
 3A< +  ;4' "	
 3A< 
7 
 
 	
       
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B 
   . ¨B	
     ¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)+¨B 
¡¦"¡¦+ . ¨B..-2+/#&.022&.&/1-.12¨B ¡¦"¡¦# . ¨B+./..0&&$1##,.-+$11--¨B ¡¦"¡¦/ . ¨B011-.+#.0.21$+-2#&.2#&$.¨B ¡¦"¡¦0 . ¨B2/0$../$0,$0#,$##--$+$¨B 
" 	
 3". 4"	
 3'&2 .  2# $- & 2: :: :: 50%16 -- # 5#%/6 2# .. .: $0 :: $: $$ $$ ./ - :: 7 4D!'&2 .  2: . $: .. +2 $+ 2: . :: 5$%#6 $- & :: ;$.E$,< 2: $- & :: :: 5$%#6 $- & 2: ;$.E$,< 
2# $- & 7 
4"	
 3'/# .  . :2 $ :: 5$%/6 /# + /2 5$%/6 .. .2 $ :: :: -- -- 2+ ./ -, :: 1 .. 7 4D!'/# .  . $: .. +2 $+ . :: $- & 2: $2 $- & :: :: $- & 2: $0 5$%+6 $- & 7 
4'   .  :: 2& /& .0 ,1 5+$%#06 :: 21 /& .0 ,1 7 
4"	
 3+ . ¨B"3
 . 
 '	
 ¨B 9  '" "'
 
 4"	
 3# . ¨B"3
 .8*"¨B 9   '" "'

 4"	
 3/ . ¨B"3
 .8*'¨B 9   '" "'

 4"	
 32 . ¨B"3
 .F ¨B 9   '" "'

 4"	
 30 . ¨B"3
 .¨B 9  '" "'
 
 4"	
 3& . ¨B"3
 .B  	
  ¨B 9   '" "'

 4"	
 31 . ¨B"3
 ."	¨B 9  '" "'
 
 4"	
 3. . ¨BG ' "¨B 9   '" "'

 4"	
 3, . ¨B"*) 3¨B 9   '" "'

 
'
	
 . ;  
	+&;$< .. $=02   
"
> ? #@  ;; 4"	
 3'&2  4D!'&2 <  ; 4"	
 3 '  /#   4D! '  /# << <  ;  
	+&;$< .. $=02   
"
> ? 2$$.  ;4'  2  ;4"	
 3A<<< 
 
 .
.
¨B. 
 	
     9    
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B 
  .¨B	
    9  ¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)$¨B 
¡¦"¡¦+ . ¨B1&.,.+,0##.#+$/0.0,+&2#22¨B ¡ã¡ã =.&  9   ¡¦"¡¦# . ¨B$.1+#+#0,1#+0.&0++2$$+¨B ¡ã¡ã =&2  9   ;' 	< 
" 	
 3". 
4 	+ . ¨BH" H"¨B 9   '" 9
  4 	# . ¨BH"¨B 9  '" 9  
4'  	G+ . ¨B$+#/20&1.,G' 3¡¦
 C D"	*9=!>.-IJBK.F@L.M8NOPQRn¡ã.)¨B 9   '" "'

 4'  	G# . ¨B=8G1I@MR¡¦ 
 $)' ..P#*O¡ãJ&Ln/F.ND"!>BC93,-2.	KQ+.0¨B 9   '" "'

 
4C"   	+ . ¨BT¨BH'T¨B.T¨BH"T¨B¨B 9  '" "'
 
 4C"   	# . ¨BH"UT¨BH"T¨B.T¨B¨B 9  '" "'
 
 
4'!	 	G .  1 20 :: # - -- -- 1 20 :: 2. . 2 #2 1 20 :: 2$ 2. ., 2+ 1 20 :: +.  2& +. 1 20 :: 00 20 . 2 1 20 :: #2 #$ .. +0 1 20 :: - -- -- 2. 1 20 :: . 2 #2 2$ 7 
'
	
 .  
	+&;$< .. $=02   
"
> ? +$$.   ;   ;4	A<   4 '!		G <   ;   ;4 '	GA<     ;4C" 	A< < 
 
!."¨B. 

 	 ¨B¨B 
 	
     FFB C'  
 
	. 
	¡¦  . ¨B..¡ã .    !"
" ¨B 
	 . ¨B#$#$%$&%##¨B 

   . ¨B	
     FFB C'	 ¨B 
' ' 	 . ¨B¡¦! ('	) )¨B 
* . ¨B+)$¨B 
¡¦"¡¦+ . ¨B,.+-$.&#0#--+.,&1.+&2.//¨B ¡ã¡ã =&2 
" 	
 3". 
4"	
 3 . ¨B"
 3 .BU 	¡¦¨B 9  '" "'
 
 4"	
 3# . ¨B8''""¨B 9   '" "'

 4"	
 3/ . ¨B-
 ¨B 9   '" "'

 4"	
 32 . ¨BH$.Q¨B 9  '" "'
 
 4"	
 30 . ¨B		N"¡¦¨B 9   '" "'

 
'
	
 . 
 
	+&;$< .. $=02   
"
> ? +0$. 
 ; ;4" 	
 3A<< 
  )
¡¦"¡¦;< .. ¨B//.1'0'&#&0 ##/11 &GG,++GG¨B 
 	
     . =!  
 
	. 
	¡¦  . ¨B..¡ã .    !"
" ¨B 
	 . ¨B#$#$%$&%##¨B 

   . ¨B	
     .=!  ¨B 
' ' 	 . ¨B¡¦! ('	) )¨B 
* . ¨B+)$¨B 
¡¦"¡¦+ . ¨B-/-.0&&,#-#$-11,1..+#+.¨B ¡ã¡ã =&2 
" 	
 3". 
4"	
 3 . ¨B.TTP
  9"TTTT@@ B " 	) 3¨B 9   '" "'

 4"	
 3# . ¨B?¡¦	V?¡¦V?	
	V2$2 L	 - ?¡ã 	
	V?¡ã¡¦V?G !V?¡¦+VL	 - ?¡ã¡¦+V?V¡¦ D"	 NF 9"       	¡¦
" "*)?¡ãV?¡ãG !V?¡ã¡¦	V¨B 9  '" "'

 4"	
 3/ . ¨B?¡¦	V?¡¦V?	
	V0$/ 8*
' N* 
G?¡ã	 
	V?¡ã¡¦V?G !V?¡¦+V8*
 ' N *
 G?¡ã¡¦+V?V¡¦ D"	 "* 
' 9" 	
    	¡¦
" "*)?¡ãV?¡ãG !V?¡ã¡¦	V¨B 9  '" "'

 
4 '	
 " .  1 :: 5+%26 2. 12 12 1$ 1 :: 5+%26 2, &. &, 12 1 :: 5+%26 &, &+ & &, 5$%+6 1 :: 5+%#6 1 &07 ¡ã¡ã ¨BJ	 	B 
	

>¨B 4 '	
 "# .  1 :: 5+%26 2. 12 12 1$ 1 :: 5+%26 2/ 1# &0 &+ 1 :: 5+%26 12 &0 0/ &0 1 :: 5+%26 1# 1& &0 1# 1 :: 5+%26 0/ &0 1/ 1/ 7 ¡ã¡ã ¨BJ		 	8*8""
 ¨B 4 '	
 "/ .  1 :: 5+%26 2. 12 12 1$ 1 :: 5+%26 2/ 1# &0 &+ 1 :: 5+%26 12 &0 00 1# 1 :: 5+%26 & 21 1# &- 5$%+6 1 :: 5+%#6 10 1$ 7 ¡ã¡ã ¨BJ			NI ¨B 4 '	
 "2 .  1 :: 5+%26 2. 12 12 1$ 1 :: 5+%26 2+ &2 &2 00 1 :: 5+%26 1# & 02 &- 1 :: 5+%26 00 1# & 21 1 :: 5+%26 1# &- 10 1$ 7 ¡ã¡ã ¨BJ	 	N NI ¨B 
 
4 '	
 "0 .  1 :: 5+%26 2. 12 12 1$ 1 :: 5+%26 2/ 1# &0 &+ 1 :: 5+%26 12 &0 0# &0 1 :: 5+%26 1+ 10 &0 1/ 1 :: 5+%26 12 0+ 10 &0 5$%+6 1 :: 5+%26 10 &07 ¡ã¡ã ¨BJ			D"	M¨B 4 '	
 "& .  1 :: 5+%26 2. 12 12 1$ 1 :: 5+%26 0/ &0 12 00 1 :: 5+%26 1# & 21 1# 1 :: 5+%26 &- 10 1$ 0$ 1 :: 5+%26 1# &- 1$ &0 1 :: 5+%26 1# 12 1, $$ 7 ¡ã¡ã ¨BJ	 	8 	NI . 	 !¨B 
4*
 ! . ¨B
 =)":H"¨B 9   '" "'

 4*
 !# . ¨B 
.$¨B 9  '" "'
 
 4*
 !/ . ¨B3
"	)"¨B 9   '" "'

 4*
 !2 . ¨B 3
 )":"
 .H"¨B 9   '" "'

 4*
 !0 . ¨B9' )":"
.H"¨B 9  '" "'
 
 4*
 !& . ¨BG 3*
 9)":" .H"¨B 9   '" "'

 
4' .  .$ 12 $2 :: :: .$ 12 $2 :: :: 2. ./ $ $# 2. :: $$ $+ $$ $$ 1 . 7 ¡ã¡ã =  $=0  $=, 
'
	
 . 
 
	+&;$< .. $=02   
"
> ? #$$. 
  ; #   ;4"	
 3A< < 
 ; ;4  '	
 "A<< 
  ; /   ;4* !A< < 
  4'  
 )
 ¡¦"¡¦;< .. ¨B& .#1$0&1+1'1/&,/##$, .1¨B 7 
 	
     .! 33  
	. 
	¡¦  . ¨B..¡ã .    !"
" ¨B 
	 . ¨B#$#$%$&%##¨B 
"' 	
   . ¨B	
     .! 33¨B 
' ' 	 . ¨B¡¦! ('	) )¨B 
* . ¨B+)$¨B 
¡¦"¡¦+ . ¨BG+$0,+# G/ $#$&/ 21.10$ +/¨B ¡¦"¡¦# . ¨B+ G+' 21,/'211 ./2+$.&.&¨B 
" 	
 3". 4"	 ' .  $- & $2 /# 2. -- # /2 &. $2 +. .. 22 /# -- 2. / / 1 . 7 
4"	
 3+ . ¨B5H)H$#)H$# H$#.H$#.H$#6¨B 9  "'

 4"	
 3# . ¨B"*'	$$$)=¨B 9  "'

 4"	
 3/ . ¨B "*'$$+)=¨B 9  "'
 
 4"	
 32 . ¨B 
 L.H" N"L.H" 8""
 B.H¨B 9  "'

 
'
	
 . 
;  
	+&;$< .. $=02   
"
> ? +$$. 
 ;4"  '< 
  #   ;4"	
 3A< < 
 )
 ¡¦"¡¦;< .. ¨B,0,#&#'201+2&#0G$/#1G2 +1 ¨B 7 
 
# ¨B. 
 	
     #3 . 8.#.3"  
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B 
    "'
 	
   . ¨B	
      #3"¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)+¨B 
" 	
 3". 4#3+"	+ . ¨BG ' ".#$$¨B 9  '" "'
 
 4#3+"	# . ¨BG ' "./$$¨B 9  '" "'
 
 4#3+"	/ . ¨BG ' ".2$$¨B 9  '" "'
 
 4#3+"	2 . ¨BG ' ".0$$¨B 9  '" "'
 
 4#3+"	0 . ¨B8	.  
 3B  ¨B 9   '" "'

 4#3+"	& . ¨B 9 F ¨B 9   '" "'

 4#3+"	1 . ¨B 9 F 8¨B 9   '" "'

 
4#3+  3 
 . ¨B'  
 3)	¨B 9   '" "'

 4#3+  3 
# . ¨BB.B$$1)	¨B 9  '" "'
 
 
4#3#"	+ . ¨B '	¨B 9   '" "'

 4#3#"	# . ¨B8	  
3¨B 9   '" "'

 4#3#"	/ . ¨B-
 9¨B 9  '" "'
 
 4#3#"	2 . ¨BN8*¨B 9  '" "'
 
 
4#3#  3 
 . ¨B' * 
3$.)3
 ¨B 9  '" "'
 
 4#3#  3 
# .  ¨BG		 !/$+)3 ¨B 9   '" "'

 
4#3/"	+ . ¨B=8G1I@MR¡¦ 
$)'  ..P#*O¡ãJ&Ln/F.ND"!>BC93,-2.	KQ+.0¨B 9   '" "'

 4#3/"	# . ¨B
.'	 .¨B 9   '" "'

 
4#32"	+ . ¨B?WR.. J@F .NFB 	¡¦ 	
'	
  .VX¨B 9  '" "'
 
 4#32"	# . ¨B.";
 ; ;< A +$$$<<¨B 4#32"	/ . ¨B@
D"	¨B 4#32"	2 . ¨B.=!¡¦'¨B 4#32"	0 . ¨B
 	J ¨B 4#32"	& . ¨B.=!F 3¨B 4#32"	1 . ¨B
 *¨B 
4#32  3 
 . ¨B¡ãG		 /)3 ¨B 9   '" "'

 4#32  3 
# . ¨B¡ãG		 0$,)3 ¨B 9   '" "'

 
4@ 
3"	+ . ¨BDG ¨B 9  '" "'
 
 4@ 
3"	# . ¨B"*' '	¨B 9   '" "'

 4@ 
3"	/ . ¨B G ¨B 9  '" "'
 
 4@ 
3"	2 . ¨B!'  '	¨B 9   '" "'

 4@ 
3"	0 . ¨BG ' ".#$$¨B 9  '" "'
 
 4@ 
3"	& . ¨BG ' ".2$$¨B 9  '" "'
 
 4@ 
3"	1 . ¨BG ' ".&$$¨B 9  '" "'
 
 4@ 
3"	. . ¨BYT¨B56;?T¨BY¨B '" "'
 
 
4@ 
3  3 
 . ¨BZQ@F8N8+--/$)	¨B 9  '" "'
 
 4@ 
3  3 
# . ¨BZQ@F8N8+--/#)	¨B 9  '" "'
 
 
¡ã¡ã4*G"'
 	  '  . ¨B?H( 33.O8'
 	). ' HV?H[(¨B 9   '" "'

 ¡ã¡ã \ ]^ _ #`abcd *G"'
 	)' e fg hij klmno 5qa rs tu vwxy) 
 
¡ã¡ã z{ |} `abu a ~.. ..¡­¡ª ¨C.. a .d ..¡ëe ..¡­.¡ª ¡°¡±xy) 
'
	
 . ;0  ;4#3+A<<  ;    ;4#3#"	A<   +   ;4#3# 3 
 A< <  ;    ;4#3/"	A< <  ;    ;4#32"	A<   +   ;4#32 3 
 A< <  ; 0  ;4@ 
3A< < ¡ã¡ã  ;4*G"'
 	  ' < ¡ã¡ã ?% .. 
 
$%¨B. 

 	 ¨B¡¦"¡¦¨B 
 	
     O " PG8¡¦ . O "8.PG8¡¦  
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B "' 	
    . ¨B	
     O "%PG8¡¦¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)$¨B 
" 	
 3". 4"	
 3+ . ¨B " 	 '! . T¨B#$''0$T¨B¨B 9  '" "'
 
 4"	
 3# . ¨B"	.9 .  '!¨B 9  '" "'
 
 4"	
 3/ . ¨B.-IJBK.F@L.M8NOPQRnG' 3¡¦
 C D"	*9=!>$+#/20&1.,¡®¡ã¨B 9   '" "'

 4"	
 32 . ¨B?¡¦#VB 	 .""9 )?¡ã¡¦#V¨B 9  '" "'
 
 4"	
 30 . ¨B.TTP
  9"TT"!"	/#TT')=¨B 9   '" "'

 4"	
 3& . ¨BC . ;C ¡® "5
6 ¡® !)'¡¦ 	; 
 H !)3	¡¦<< H #0&¨B 9   '" "'

 4"	
 31 . ¨B* '! . ¡¯T¨B Y  '! Y T¨B¡¯X¨B 9  '" "'
 
 
'
	
 . ; 
 "
 > ? 10.  2  	¡¦ <  ¡¦"¡¦)0;$U 
"
>< .. ¨B#, '$'/120+1'&&G/,2'&.$0'¨B 
 	
     J 	" PG8¡¦ .  J	 "8. PG8¡¦  
	. 	¡¦  . ¨B..¡ã .    !"
" ¨B 	 . ¨B#$#$%$&%##¨B "' 	
    . ¨B	
      %J	 "%PG8¡¦¨B ' ' 	 . ¨B¡¦! ('	) )¨B * . ¨B+)$¨B 
" 	
 3". 4"	
 3+ . ¨B?	
	V  J 	" 8¡¦?¡ã	
	V¨B 4"	
 3# . ¨B8'	 " 
"¨B  '" "'

 
4"	
 3/ . ¨B:
".	-
¨B  '" "'

 4"	
 32 . ¨B:
".-@ *¨B '" "'
 
 4"	
 30 . ¨B:
".- !¨B  '" "'

 4"	
 3& . ¨B:
".-	 ¨B '" "'
 
 4"	
 31 . ¨B:
".-
 ¨B  '" "'

 4"	
 3. . ¨B:
".
  
¨B  '" "'

 
4"	
 3, . ¨B" T¨B3
	 T¨B¨B  '" "'

 4"	
 3+$ . ¨B" T¨B 
*"T¨B¨B  '" "'

 4"	
 3++ . ¨B" T¨BT¨B¨B  '" "'

 4"	
 3+# . ¨B" T¨B-
 T¨B¨B  '" "'

 4"	
 3+/ . ¨B" T¨B.
	T¨B¨B  '" "'

 4"	
 3+2 . ¨B" T¨B- T¨B¨B  '" "'

 4"	
 3+0 . ¨B" T¨B-@ *T¨B¨B '" "'
 
 4"	
 3+& . ¨B" T¨B- !T¨B¨B  '" "'

 4"	
 3+1 . ¨B" T¨B-
 !T¨B¨B  '" "'

 4"	
 3+. . ¨B" T¨B-
@ *T¨B¨B '" "'
 
 4"	
 3+, . ¨B" T¨B-	T¨B¨B '" "'
 
 
 
4"	
 3#$ . ¨B
 !8	)8* -
 .	¡¦YT¨BTTT¨BY 
3¡¦	;NU; ;N<%
 "	*;NUT¨B¡ãT¨B<<<U #¨B  '" "'

 
'
	
 . 
; 
 "
 > ? /$. 
  +$  	¡¦ < 
 ¡¦"¡¦)0;$U 
"
>< .. ¨B.21& $2G#G''GG/12G&$'$G/2,¨B 
7 
 	
     P8PG8¡¦ . P8.J.PG8¡¦ 
 
	. 
	¡¦  . ¨B..¡ã .    !"
" ¨B 
	 . ¨B#$#$%$&%##¨B 
"' 	
    . ¨B	
     P8%PG8¡¦¨B 
' ' 	 . ¨B¡¦! ('	) )¨B 
* . ¨B+)$¨B 
" 	
 3". 
4"	
 3+ . ¨B?:¡¦¨B 
4"	
 3# . ¨B*;T¨B:VT¨B¨B 9   '" "'

 
4"	
 3/ . ¨B3> ' "";G"&2' ;T¨BK>*P	QI.'8..¨B '" "'
 
 
'
	
 . 
; 
 "
 > ? /$. 
    	¡¦ < 
 ¡¦"¡¦)0;$U 
"
>< .. ¨B/'0 '$G'22$0/,G., 2G21.#¨B 
7 
 	
     J	PG8¡¦ . ¡¦	8.PG8¡¦ 
 
	. 
	¡¦  . ¨B..¡ã .    !"
" ¨B 
	 . ¨B#$#$%$&%##¨B 
"' 	
    . ¨B	
     J	%PG8¡¦¨B 
' ' 	 . ¨B¡¦! ('	) )¨B 
* . ¨B+)$¨B 
" 	
 3". 
4"	
 3+ . ¨B' "	 *3 .T¨B
 T¨B¨B 9  "'
 
 
4"	
 3# . ¨B' "	 9.T¨B¡¦	T¨B¨B 9  "'
 
 
4"	
 3/ . ¨B' "	 .T¨B9 	)"T¨B¨B 9  "'
 
 
4"	
 32 . ¨B' "	 9.T¨B¡¦	T¨B¨B 9  "'
 
 
4"	
 30 . ¨B' "	 =.T¨B¡¦	T¨B¨B 9  "'
 
 
4"	
 3& . ¨B' "	 !'.T¨B¡¦	 ¡¦'T¨B¨B 9  "'

 
4"	
 31 . ¨B' "	 *	.T¨B¡¦	)¡¦	T¨B¨B 9  "'

 
4"	
 3. . ¨B='	  !¨B 9  "'

 
 ' 
	
 . 
; 
 "
 > ? +$$. 
    	¡¦ < 
 ¡¦"¡¦)0;$U 
"
>< .. ¨B0  . G+1+//',#$#$01+&' /../¨B 
7 



